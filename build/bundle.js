var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function h(){return u(" ")}function d(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function f(t){return function(e){return e.preventDefault(),t.call(this,e)}}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function p(t){return""===t?null:+t}function x(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}let v;function $(t){v=t}function b(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const y=[],w=[],k=[],M=[],S=Promise.resolve();let C=!1;function P(t){k.push(t)}const E=new Set;let H=0;function _(){const t=v;do{for(;H<y.length;){const t=y[H];H++,$(t),L(t.$$)}for($(null),y.length=0,H=0;w.length;)w.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];E.has(e)||(E.add(e),e())}k.length=0}while(y.length);for(;M.length;)M.pop()();C=!1,E.clear(),$(t)}function L(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const T=new Set;let z;function A(t,e){t&&t.i&&(T.delete(t),t.i(e))}function D(t,e,n,r){if(t&&t.o){if(T.has(t))return;T.add(t),z.c.push((()=>{T.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function F(t){t&&t.c()}function W(t,n,i,o){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=t.$$;a&&a.m(n,i),o||P((()=>{const n=l.map(e).filter(s);c?c.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(P)}function G(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function j(t,e){-1===t.$$.dirty[0]&&(y.push(t),C||(C=!0,S.then(_)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function q(e,s,i,o,a,c,u,h=[-1]){const d=v;$(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(d?d.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:s.target||d.$$.root};u&&u(f.root);let m=!1;if(f.ctx=i?i(e,s.props||{},((t,n,...r)=>{const s=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),m&&j(e,t)),n})):[],f.update(),m=!0,r(f.before_update),f.fragment=!!o&&o(f.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);f.fragment&&f.fragment.l(t),t.forEach(l)}else f.fragment&&f.fragment.c();s.intro&&A(e.$$.fragment),W(e,s.target,s.anchor,s.customElement),_()}$(d)}class R{$destroy(){G(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function N(e){let n,r,s,i,h,d,f,m,p,g,v,$,b,y=e[0].markers[0].name+"",w=e[0].markers[e[0].markers.length-1].name+"",k=Math.round(e[0].distanceSum[e[0].line.length-1])+"";return{c(){n=u("Start: "),r=c("b"),s=u(y),i=c("br"),h=u("\r\nEnde: "),d=c("b"),f=u(w),m=c("br"),p=u("\r\nDistanz: "),g=c("b"),v=u(k),$=u(" m"),b=c("br")},m(t,e){a(t,n,e),a(t,r,e),o(r,s),a(t,i,e),a(t,h,e),a(t,d,e),o(d,f),a(t,m,e),a(t,p,e),a(t,g,e),o(g,v),o(g,$),a(t,b,e)},p(t,[e]){1&e&&y!==(y=t[0].markers[0].name+"")&&x(s,y),1&e&&w!==(w=t[0].markers[t[0].markers.length-1].name+"")&&x(f,w),1&e&&k!==(k=Math.round(t[0].distanceSum[t[0].line.length-1])+"")&&x(v,k)},i:t,o:t,d(t){t&&l(n),t&&l(r),t&&l(i),t&&l(h),t&&l(d),t&&l(m),t&&l(p),t&&l(g),t&&l(b)}}}function O(t,e,n){let{route:r}=e;return t.$$set=t=>{"route"in t&&n(0,r=t.route)},[r]}class B extends R{constructor(t){super(),q(this,t,O,N,i,{route:0})}}class X{static equal(t,e){return t.x===e.x&&t.y===e.y}static add(t,e){return{x:t.x+e.x,y:t.y+e.y}}static subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}static multiply(t,e){return{x:t.x*e.x,y:t.y*e.y}}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static scale(t,e){return{x:t.x*e,y:t.y*e}}static rotate(t,e){return{x:Math.cos(e)*t.x-Math.sin(e)*t.y,y:Math.sin(e)*t.x+Math.cos(e)*t.y}}static angle(t){return Math.atan2(t.y,t.x)}static length(t){return Math.hypot(t.x,t.y)}static length2(t){return t.x**2+t.y**2}static normalize(t){const e=X.length(t);return 0===e?t:X.scale(t,1/e)}static floor(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}static flip(t){return{x:t.y,y:t.x}}static distance(t,e){return X.length(X.subtract(e,t))}static distance2(t,e){return X.length2(X.subtract(e,t))}}const I={backgroundColor:"#fff",textColor:"#222",darkerAccentColor:"#214B00",accentColor:"#3C7113",lighterAccentColor:"#87BC5E"};for(let t of Object.keys(I)){const e="--"+t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));document.documentElement.style.setProperty(e,I[t])}function J(e){let n;return{c(){n=c("canvas"),m(n,"width","800"),m(n,"height","150"),m(n,"class","svelte-xd84ci")},m(t,r){a(t,n,r),e[2](n)},p:t,i:t,o:t,d(t){t&&l(n),e[2](null)}}}function K(t,e,n){let r,{route:s}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{3&t.$$.dirty&&r&&function(t,e){const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);const r=12;let s=1/0,i=-1/0;for(let e of t.lineProfile)s=Math.min(s,e.height),i=Math.max(i,e.height);const o={x:t.distanceSum[t.distanceSum.length-1],y:i-s},a=Math.min((e.width-24)/o.x,(e.height-24-40)/o.y);e.width=Math.ceil(o.x*a+24),e.height=Math.ceil(o.y*a+24+40);const l=(t,n)=>X.add(X.scale({x:t,y:s-n},a),{x:r,y:e.height-r-40}),c=()=>{for(let e=0;e<t.lineProfile.length;e++){const r=l(t.lineProfileDistanceSum[e],t.lineProfile[e].height);0===e?n.moveTo(r.x,r.y):n.lineTo(r.x,r.y)}};n.beginPath(),c();const u=l(0,i),h=l(0,s),d=l(o.x,s);n.lineTo(d.x,e.height),n.lineTo(h.x,e.height);const f=n.createLinearGradient(0,u.y,0,e.height);f.addColorStop(0,I.lighterAccentColor),f.addColorStop(1,I.backgroundColor),n.fillStyle=f,n.globalAlpha=.5,n.fill(),n.globalAlpha=1,n.beginPath(),c(),n.lineWidth=4,n.lineCap=n.lineJoin="round",n.strokeStyle=I.accentColor,n.stroke(),n.font="bold 14px sans-serif",n.textAlign="center",n.textBaseline="middle";for(let e=0;e<t.markerProfile.length;e++){const r=l(t.distanceSum[t.markers[e].index],t.markerProfile[e].height);n.beginPath(),n.arc(r.x,r.y,10,0,2*Math.PI),n.fillStyle=I.darkerAccentColor,n.fill(),n.fillStyle=I.backgroundColor,n.fillText(e+1,r.x,r.y+.5)}}(s,r)},[r,s,function(t){w[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class U extends R{constructor(t){super(),q(this,t,K,J,i,{route:1})}}function Z(t,e,n){const r=t.slice();return r[3]=e[n],r}function V(t){let e,n,r,s,i,d,f,p,g,v,$,b,y,w,k,M,S,C,P,E,H,_,L,T,z=Math.round(t[3].diff.height)+"",A=t[3].diff.distance.toFixed(1)+"",D=t[3].diff.effort.toFixed(1)+"",F=Math.round(t[3].diff.time)+"";return{c(){e=c("tr"),n=c("td"),r=h(),s=c("td"),i=h(),d=c("td"),f=u(z),p=h(),g=c("td"),g.textContent="m",v=h(),$=c("td"),b=u(A),y=h(),w=c("td"),w.textContent="km",k=h(),M=c("td"),S=u(D),C=h(),P=c("td"),P.textContent="Lkm",E=h(),H=c("td"),_=u(F),L=h(),T=c("td"),T.textContent="min",m(n,"class","svelte-1usxarx"),m(s,"class","svelte-1usxarx"),m(d,"class","number svelte-1usxarx"),m(g,"class","unit svelte-1usxarx"),m($,"class","number svelte-1usxarx"),m(w,"class","unit svelte-1usxarx"),m(M,"class","number svelte-1usxarx"),m(P,"class","unit svelte-1usxarx"),m(H,"class","number svelte-1usxarx"),m(T,"class","unit svelte-1usxarx"),m(e,"class","alt svelte-1usxarx")},m(t,l){a(t,e,l),o(e,n),o(e,r),o(e,s),o(e,i),o(e,d),o(d,f),o(e,p),o(e,g),o(e,v),o(e,$),o($,b),o(e,y),o(e,w),o(e,k),o(e,M),o(M,S),o(e,C),o(e,P),o(e,E),o(e,H),o(H,_),o(e,L),o(e,T)},p(t,e){1&e&&z!==(z=Math.round(t[3].diff.height)+"")&&x(f,z),1&e&&A!==(A=t[3].diff.distance.toFixed(1)+"")&&x(b,A),1&e&&D!==(D=t[3].diff.effort.toFixed(1)+"")&&x(S,D),1&e&&F!==(F=Math.round(t[3].diff.time)+"")&&x(_,F)},d(t){t&&l(e)}}}function Q(t){let e,n,r,s,i,d,f,p,g,v,$,b,y,w,k,M,S,C,P,E,H,_,L,T,z,A,D,F,W,G=t[3].index+"",j=t[3].name+"",q=Math.round(t[3].height)+"",R=t[3].distance.toFixed(1)+"",N=t[3].effort.toFixed(1)+"",O=Math.round(t[3].time)+"",B=t[3].diff&&V(t);return{c(){B&&B.c(),e=h(),n=c("tr"),r=c("td"),s=c("span"),i=u(G),d=h(),f=c("td"),p=u(j),g=h(),v=c("td"),$=u(q),b=h(),y=c("td"),y.textContent="m",w=h(),k=c("td"),M=u(R),S=h(),C=c("td"),C.textContent="km",P=h(),E=c("td"),H=u(N),_=h(),L=c("td"),L.textContent="Lkm",T=h(),z=c("td"),A=u(O),D=h(),F=c("td"),F.textContent="min",W=h(),m(s,"class","svelte-1usxarx"),m(r,"class","index svelte-1usxarx"),m(f,"class","name svelte-1usxarx"),m(v,"class","number svelte-1usxarx"),m(y,"class","unit svelte-1usxarx"),m(k,"class","number svelte-1usxarx"),m(C,"class","unit svelte-1usxarx"),m(E,"class","number svelte-1usxarx"),m(L,"class","unit svelte-1usxarx"),m(z,"class","number svelte-1usxarx"),m(F,"class","unit svelte-1usxarx")},m(t,l){B&&B.m(t,l),a(t,e,l),a(t,n,l),o(n,r),o(r,s),o(s,i),o(n,d),o(n,f),o(f,p),o(n,g),o(n,v),o(v,$),o(n,b),o(n,y),o(n,w),o(n,k),o(k,M),o(n,S),o(n,C),o(n,P),o(n,E),o(E,H),o(n,_),o(n,L),o(n,T),o(n,z),o(z,A),o(n,D),o(n,F),o(n,W)},p(t,n){t[3].diff?B?B.p(t,n):(B=V(t),B.c(),B.m(e.parentNode,e)):B&&(B.d(1),B=null),1&n&&G!==(G=t[3].index+"")&&x(i,G),1&n&&j!==(j=t[3].name+"")&&x(p,j),1&n&&q!==(q=Math.round(t[3].height)+"")&&x($,q),1&n&&R!==(R=t[3].distance.toFixed(1)+"")&&x(M,R),1&n&&N!==(N=t[3].effort.toFixed(1)+"")&&x(H,N),1&n&&O!==(O=Math.round(t[3].time)+"")&&x(A,O)},d(t){B&&B.d(t),t&&l(e),t&&l(n)}}}function Y(e){let n,r,s,i=e[0],u=[];for(let t=0;t<i.length;t+=1)u[t]=Q(Z(e,i,t));return{c(){n=c("table"),r=c("tr"),r.innerHTML='<th class="svelte-1usxarx"></th> \n        <th class="svelte-1usxarx">Wegpunkt</th> \n        <th colspan="2" class="svelte-1usxarx">Höhe</th> \n        <th colspan="2" class="svelte-1usxarx">Distanz</th> \n        <th colspan="2" class="svelte-1usxarx">Aufwand</th> \n        <th colspan="2" class="svelte-1usxarx">Zeit</th>',s=h();for(let t=0;t<u.length;t+=1)u[t].c();m(n,"class","svelte-1usxarx")},m(t,e){a(t,n,e),o(n,r),o(n,s);for(let t=0;t<u.length;t+=1)u[t].m(n,null)},p(t,[e]){if(1&e){let r;for(i=t[0],r=0;r<i.length;r+=1){const s=Z(t,i,r);u[r]?u[r].p(s,e):(u[r]=Q(s),u[r].c(),u[r].m(n,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=i.length}},i:t,o:t,d(t){t&&l(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(u,t)}}}function tt(t,e,n){let{route:r}=e,{speed:s}=e,i=[];return t.$$set=t=>{"route"in t&&n(1,r=t.route),"speed"in t&&n(2,s=t.speed)},t.$$.update=()=>{6&t.$$.dirty&&!window.isNaN(s)&&s>0&&n(0,i=function(t,e){const n=[];for(let r=0;r<t.markers.length;r++)n[r]={index:r+1,name:t.markers[r].name,height:t.markerProfile[r].height,distance:t.distanceSum[t.markers[r].index]/1e3,effort:t.effortSum[r],time:t.effortSum[r]/e*60},r>0&&(n[r].diff={height:n[r].height-n[r-1].height,distance:n[r].distance-n[r-1].distance,effort:t.effort[r],time:n[r].time-n[r-1].time});return n}(r,s))},[i,r,s]}class et extends R{constructor(t){super(),q(this,t,tt,Y,i,{route:1,speed:2})}}function nt(e){let n,r,s;return{c(){n=c("div"),n.innerHTML='<h1 class="svelte-1578vb4">Marschzeit­tabelle<br/>leicht gemacht.</h1> \n<p class="subtitle svelte-1578vb4">Wir übertragen deine Route automatisch in eine Marschzeittabelle, damit du dich auf die wichtigen Teile der Planung konzentrieren kannst.</p>',r=h(),s=c("div"),s.innerHTML='<div class="svelte-1578vb4"><h2 class="svelte-1578vb4">1. Route planen</h2> \n        <p class="svelte-1578vb4">Route einzeichnen, Wegpunkte setzen - das kennst du bereits.</p> \n        <h2 class="svelte-1578vb4">2. Exportieren und hochladen</h2> \n        <p class="svelte-1578vb4">In wenigen Klicks erledigt.</p> \n        <h2 class="svelte-1578vb4">3. Voilà!</h2> \n        <p class="svelte-1578vb4">Schon hast du deine Marschzeittabelle. Jetzt noch Geschwindigkeit, Uhrzeit und Pausen anpassen.</p></div> \n    <img src="example.png" alt="Beispiel" class="svelte-1578vb4"/>',m(n,"class","title svelte-1578vb4"),m(s,"class","tutorial svelte-1578vb4")},m(t,e){a(t,n,e),a(t,r,e),a(t,s,e)},p:t,i:t,o:t,d(t){t&&l(n),t&&l(r),t&&l(s)}}}class rt extends R{constructor(t){super(),q(this,t,null,nt,i,{})}}function st(t,e,n){const r={type:"LineString",coordinates:t.map((t=>[Math.round(t.x),Math.round(t.y)]))};return fetch(`https://api3.geo.admin.ch/rest/services/profile.json?sr=21781&distinct_points=${e}&nb_points=${n}&geom=${JSON.stringify(r)}`).then((t=>t.json())).then((n=>new Promise((r=>{let s=n.map((t=>({point:{x:t.easting,y:t.northing},height:t.alts.COMB})));e&&(s=s.filter((e=>t.some((t=>X.distance(e.point,t)<2))))),r(s)}))))}class it{constructor(t,e){this.line=t,this.markers=e}async loadProfiles(){this.lineProfile=await st(this.line,!1,100),this.markerProfile=await st(this.markers.map((t=>this.line[t.index])),!0,this.markers.length),this.calculateDistances()}reverse(){this.line.reverse(),this.markers.reverse(),this.markers.forEach((t=>t.index=this.line.length-t.index-1)),this.lineProfile?.reverse(),this.markerProfile?.reverse(),this.calculateDistances()}calculateDistances(){this.distanceSum=ot(this.line),this.lineProfileDistanceSum=ot(this.lineProfile.map((t=>t.point))),this.effort=[],this.effort[0]=0;for(let t=1;t<this.markers.length;t++){const e=this.distanceSum[this.markers[t].index]-this.distanceSum[this.markers[t-1].index],n=this.markerProfile[t].height-this.markerProfile[t-1].height,r=n/e;this.effort[t]=e/1e3,r>0?this.effort[t]+=n/100:r<-.2&&(this.effort[t]+=Math.abs(r)/150)}this.effortSum=at(this.effort)}}function ot(t){return at(t.map(((e,n)=>X.distance(t[Math.max(0,n-1)],t[n]))))}function at(t){const e=[];let n=0;for(let r=0;r<t.length;r++)n+=t[r],e[r]=n;return e}function lt(t){const e=t.split(",").map((t=>Number(t))),n=class{static WGStoCH(t,e){return[this.WGStoCHy(t,e),this.WGStoCHx(t,e)]}static WGStoCHx(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 200147.07+308807.95*n+3745.25*Math.pow(r,2)+76.63*Math.pow(n,2)-194.56*Math.pow(r,2)*n+119.79*Math.pow(n,3)}static WGStoCHy(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 600072.37+211455.93*r-10938.51*r*n-.36*r*Math.pow(n,2)-44.54*Math.pow(r,3)}static CHtoWGS(t,e){return[this.CHtoWGSlng(t,e),this.CHtoWGSlat(t,e)]}static CHtoWGSlat(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(16.9023892+3.238272*r-.270978*Math.pow(n,2)-.002528*Math.pow(r,2)-.0447*Math.pow(n,2)*r-.014*Math.pow(r,3))/36}static CHtoWGSlng(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(2.6779094+4.728982*n+.791484*n*r+.1306*n*Math.pow(r,2)-.0436*Math.pow(n,3))/36}static DECtoSEX(t){const e=parseInt(t),n=parseInt(60*(t-e));return 60*(60*(t-e)-n)+60*n+3600*e}}.WGStoCH(e[1],e[0]);return{x:n[0],y:n[1]}}function ct(t){const e=(t,e)=>X.distance(t,e)<2;for(let n=0;n<t.length;n++)for(let r=n+1;r<t.length;r++){if(e(t[n][t[n].length-1],t[r][0]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!1};if(e(t[n][0],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!0};if(e(t[n][0],t[r][0]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!1};if(e(t[n][t[n].length-1],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!0}}return null}function ut(e){let n;return{c(){n=c("h3"),n.textContent="Route wird gewandert..."},m(t,e){a(t,n,e)},p:t,d(t){t&&l(n)}}}function ht(e){let n,r,s,i,o,u,f,p,x,g,v,$,b;return{c(){n=c("h2"),n.textContent="Route hochladen",r=h(),s=c("p"),s.innerHTML='Unterstützt sind Exporte im <b>KML-Format</b> von <a href="https://map.geo.admin.ch" target="_blank">map.geo.admin.ch</a> oder der <a href="https://www.swisstopo.admin.ch/en/maps-data-online/maps-geodata-online/swisstopo-app.html" target="_blank">swisstopo-App</a>.',i=h(),o=c("p"),o.textContent="Datei hierher ziehen oder...",u=h(),f=c("input"),p=h(),x=c("button"),x.innerHTML='<label for="upload" class="svelte-x4w5y3">Datei auswählen</label>',g=h(),v=c("br"),m(n,"class","svelte-x4w5y3"),m(f,"type","file"),m(f,"id","upload"),m(f,"accept",".kml"),m(f,"class","svelte-x4w5y3")},m(t,l){a(t,n,l),a(t,r,l),a(t,s,l),a(t,i,l),a(t,o,l),a(t,u,l),a(t,f,l),a(t,p,l),a(t,x,l),a(t,g,l),a(t,v,l),$||(b=d(f,"change",e[3]),$=!0)},p:t,d(t){t&&l(n),t&&l(r),t&&l(s),t&&l(i),t&&l(o),t&&l(u),t&&l(f),t&&l(p),t&&l(x),t&&l(g),t&&l(v),$=!1,b()}}}function dt(e){let n,s,i;function o(t,e){return t[0]&&t[0][0]?ut:ht}let u=o(e),h=u(e);return{c(){n=c("div"),h.c(),m(n,"class","svelte-x4w5y3")},m(t,r){a(t,n,r),h.m(n,null),s||(i=[d(n,"drop",f(e[4])),d(n,"dragover",f(e[2]))],s=!0)},p(t,[e]){u===(u=o(t))&&h?h.p(t,e):(h.d(1),h=u(t),h&&(h.c(),h.m(n,null)))},i:t,o:t,d(t){t&&l(n),h.d(),s=!1,r(i)}}}function ft(t,e,n){let r,{route:s=null}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{if(1&t.$$.dirty&&r&&r[0]){const t=new FileReader;t.addEventListener("load",(()=>{const e=function(t){const e=[],n=[],r=(new DOMParser).parseFromString(t,"application/xml").querySelectorAll("Placemark");for(let t of r){if(t.querySelector("LineString")){const n=t.querySelector("LineString coordinates").innerHTML.trim().split(" ").map((t=>lt(t)));e.push(n)}if(t.querySelector("Point")){const e=t.querySelector("name").innerHTML.trim(),r=lt(t.querySelector("Point coordinates").innerHTML);n.push({name:e,point:r})}}for(;e.length>1;){const t=ct(e);if(null==t)return void console.error("Lines are not connected");t.reverseFirst&&e[t.i].reverse(),t.reverseSecond&&e[t.j].reverse(),e[t.i].push(...e[t.j]),e.splice(t.j,1)}const s=e[0];for(let t of n){let e=0,n=1/0;for(let r=0;r<s.length;r++){const i=X.distance(t.point,s[r]);i<n&&(e=r,n=i)}t.index=e,delete t.point}return n.sort(((t,e)=>t.index-e.index)),new it(s,n)}(t.result);e.loadProfiles().then((()=>n(1,s=e)))})),t.readAsText(r[0])}},[r,s,function(e){b.call(this,t,e)},function(){r=this.files,n(0,r)},t=>n(0,r=t.dataTransfer.files)]}class mt extends R{constructor(t){super(),q(this,t,ft,dt,i,{route:1})}}function pt(t){let e,n,r,s,i;function o(e){t[4](e)}e=new rt({});let c={};return void 0!==t[0]&&(c.route=t[0]),r=new mt({props:c}),w.push((()=>function(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}(r,"route",o))),{c(){F(e.$$.fragment),n=h(),F(r.$$.fragment)},m(t,s){W(e,t,s),a(t,n,s),W(r,t,s),i=!0},p(t,e){const n={};var i;!s&&1&e&&(s=!0,n.route=t[0],i=()=>s=!1,M.push(i)),r.$set(n)},i(t){i||(A(e.$$.fragment,t),A(r.$$.fragment,t),i=!0)},o(t){D(e.$$.fragment,t),D(r.$$.fragment,t),i=!1},d(t){G(e,t),t&&l(n),G(r,t)}}}function xt(t){let e,n,s,i,u,f,x,v,$,b,y,w,k,M,S,C,P,E,H,_,L,T,z,j,q,R,N,O,X,I,J,K,Z,V,Q,Y;return f=new B({props:{route:t[0]}}),O=new et({props:{route:t[0],speed:t[1]}}),Z=new U({props:{route:t[0]}}),{c(){e=c("div"),n=c("div"),s=c("div"),i=c("h2"),i.textContent="Route",u=h(),F(f.$$.fragment),x=h(),v=c("div"),$=c("h2"),$.textContent="Optionen",b=h(),y=c("label"),y.textContent="Geschwindigkeit in Lkm/h",w=h(),k=c("input"),M=h(),S=c("br"),C=h(),P=c("button"),P.textContent="Richtung wechseln",E=h(),H=c("br"),_=h(),L=c("br"),T=h(),z=c("button"),z.textContent="Herunterladen",j=h(),q=c("div"),R=c("h2"),R.textContent="Marschzeittabelle",N=h(),F(O.$$.fragment),X=h(),I=c("div"),J=c("h2"),J.textContent="Höhenprofil",K=h(),F(Z.$$.fragment),m(s,"class","info"),m(y,"for","speed"),m(y,"class","svelte-125mwom"),m(k,"id","speed"),m(k,"type","number"),m(k,"min","0.5"),m(k,"step","0.5"),m(k,"class","svelte-125mwom"),m(P,"class","secondary"),m(v,"class","options svelte-125mwom"),m(n,"class","general svelte-125mwom"),m(q,"class","table svelte-125mwom"),m(I,"class","profile svelte-125mwom"),m(e,"class","editor")},m(r,l){a(r,e,l),o(e,n),o(n,s),o(s,i),o(s,u),W(f,s,null),o(n,x),o(n,v),o(v,$),o(v,b),o(v,y),o(v,w),o(v,k),g(k,t[1]),o(v,M),o(v,S),o(v,C),o(v,P),o(v,E),o(v,H),o(v,_),o(v,L),o(v,T),o(v,z),o(e,j),o(e,q),o(q,R),o(q,N),W(O,q,null),o(e,X),o(e,I),o(I,J),o(I,K),W(Z,I,null),V=!0,Q||(Y=[d(k,"input",t[3]),d(P,"click",t[2]),d(z,"click",vt)],Q=!0)},p(t,e){const n={};1&e&&(n.route=t[0]),f.$set(n),2&e&&p(k.value)!==t[1]&&g(k,t[1]);const r={};1&e&&(r.route=t[0]),2&e&&(r.speed=t[1]),O.$set(r);const s={};1&e&&(s.route=t[0]),Z.$set(s)},i(t){V||(A(f.$$.fragment,t),A(O.$$.fragment,t),A(Z.$$.fragment,t),V=!0)},o(t){D(f.$$.fragment,t),D(O.$$.fragment,t),D(Z.$$.fragment,t),V=!1},d(t){t&&l(e),G(f),G(O),G(Z),Q=!1,r(Y)}}}function gt(t){let e,n,s,i,o,u,d,f;const p=[xt,pt],x=[];function g(t,e){return t[0]?0:1}return i=g(t),o=x[i]=p[i](t),{c(){e=c("header"),e.innerHTML='<span><a href="">startseite</a></span> \n    <span><a href="#">über diese seite</a> |\n        <a href="#">faq</a> |\n        <a href="https://github.com/ckolin/marschzeittabelle">github</a></span>',n=h(),s=c("main"),o.c(),u=h(),d=c("footer"),d.textContent="marschzeittabelle.ch",m(e,"class","svelte-125mwom"),m(d,"class","svelte-125mwom")},m(t,r){a(t,e,r),a(t,n,r),a(t,s,r),x[i].m(s,null),a(t,u,r),a(t,d,r),f=!0},p(t,[e]){let n=i;i=g(t),i===n?x[i].p(t,e):(z={r:0,c:[],p:z},D(x[n],1,1,(()=>{x[n]=null})),z.r||r(z.c),z=z.p,o=x[i],o?o.p(t,e):(o=x[i]=p[i](t),o.c()),A(o,1),o.m(s,null))},i(t){f||(A(o),f=!0)},o(t){D(o),f=!1},d(t){t&&l(e),t&&l(n),t&&l(s),x[i].d(),t&&l(u),t&&l(d)}}}function vt(){window.print()}function $t(t,e,n){let r,s=4;return[r,s,function(){r.reverse(),n(0,r)},function(){s=p(this.value),n(1,s)},function(t){r=t,n(0,r)}]}return new class extends R{constructor(t){super(),q(this,t,$t,gt,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
