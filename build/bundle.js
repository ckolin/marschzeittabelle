var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function h(){return u(" ")}function f(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function d(t){return function(e){return e.preventDefault(),t.call(this,e)}}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function p(t){return""===t?null:+t}function x(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}let $;function v(t){$=t}function y(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const b=[],k=[],S=[],w=[],C=Promise.resolve();let M=!1;function P(t){S.push(t)}const q=new Set;let E=0;function _(){const t=$;do{for(;E<b.length;){const t=b[E];E++,v(t),H(t.$$)}for(v(null),b.length=0,E=0;k.length;)k.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];q.has(e)||(q.add(e),e())}S.length=0}while(b.length);for(;w.length;)w.pop()();M=!1,q.clear(),v(t)}function H(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const j=new Set;let L;function T(t,e){t&&t.i&&(j.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(j.has(t))return;j.add(t),L.c.push((()=>{j.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function A(t){t&&t.c()}function D(t,n,i,o){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=t.$$;a&&a.m(n,i),o||P((()=>{const n=l.map(e).filter(s);c?c.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(P)}function F(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(b.push(t),M||(M=!0,C.then(_)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function G(e,s,i,o,a,c,u,h=[-1]){const f=$;v(e);const d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(f?f.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:s.target||f.$$.root};u&&u(d.root);let m=!1;if(d.ctx=i?i(e,s.props||{},((t,n,...r)=>{const s=r.length?r[0]:n;return d.ctx&&a(d.ctx[t],d.ctx[t]=s)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](s),m&&W(e,t)),n})):[],d.update(),m=!0,r(d.before_update),d.fragment=!!o&&o(d.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);d.fragment&&d.fragment.l(t),t.forEach(l)}else d.fragment&&d.fragment.c();s.intro&&T(e.$$.fragment),D(e,s.target,s.anchor,s.customElement),_()}v(f)}class R{$destroy(){F(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function N(e){let n,r,s,i,h,f,d,m,p,g,$,v,y,b=e[0].markers[0].name+"",k=e[0].markers[e[0].markers.length-1].name+"",S=Math.round(e[0].distanceSum[e[0].line.length-1])+"";return{c(){n=u("Start: "),r=c("b"),s=u(b),i=c("br"),h=u("\r\nEnde: "),f=c("b"),d=u(k),m=c("br"),p=u("\r\nDistanz: "),g=c("b"),$=u(S),v=u(" m"),y=c("br")},m(t,e){a(t,n,e),a(t,r,e),o(r,s),a(t,i,e),a(t,h,e),a(t,f,e),o(f,d),a(t,m,e),a(t,p,e),a(t,g,e),o(g,$),o(g,v),a(t,y,e)},p(t,[e]){1&e&&b!==(b=t[0].markers[0].name+"")&&x(s,b),1&e&&k!==(k=t[0].markers[t[0].markers.length-1].name+"")&&x(d,k),1&e&&S!==(S=Math.round(t[0].distanceSum[t[0].line.length-1])+"")&&x($,S)},i:t,o:t,d(t){t&&l(n),t&&l(r),t&&l(i),t&&l(h),t&&l(f),t&&l(m),t&&l(p),t&&l(g),t&&l(y)}}}function O(t,e,n){let{route:r}=e;return t.$$set=t=>{"route"in t&&n(0,r=t.route)},[r]}class B extends R{constructor(t){super(),G(this,t,O,N,i,{route:0})}}class X{static equal(t,e){return t.x===e.x&&t.y===e.y}static add(t,e){return{x:t.x+e.x,y:t.y+e.y}}static subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}static multiply(t,e){return{x:t.x*e.x,y:t.y*e.y}}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static scale(t,e){return{x:t.x*e,y:t.y*e}}static rotate(t,e){return{x:Math.cos(e)*t.x-Math.sin(e)*t.y,y:Math.sin(e)*t.x+Math.cos(e)*t.y}}static angle(t){return Math.atan2(t.y,t.x)}static length(t){return Math.hypot(t.x,t.y)}static length2(t){return t.x**2+t.y**2}static normalize(t){const e=X.length(t);return 0===e?t:X.scale(t,1/e)}static floor(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}static flip(t){return{x:t.y,y:t.x}}static distance(t,e){return X.length(X.subtract(e,t))}static distance2(t,e){return X.length2(X.subtract(e,t))}}const I={backgroundColor:"white",textColor:"#222",darkerAccentColor:"#214B00",accentColor:"#3C7113",lighterAccentColor:"#87BC5E"};function J(e){let n;return{c(){n=c("canvas"),m(n,"width","800"),m(n,"height","100")},m(t,r){a(t,n,r),e[2](n)},p:t,i:t,o:t,d(t){t&&l(n),e[2](null)}}}function K(t,e,n){let r,{route:s}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{3&t.$$.dirty&&r&&function(t,e){const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);let r=1/0,s=-1/0;for(let e of t.lineProfile)r=Math.min(r,e.height),s=Math.max(s,e.height);const i=t.distanceSum[t.distanceSum.length-1],o=s-r,a={x:.5*i,y:r+.5*o},l=Math.min((e.height-20)/o,(e.width-20)/i),c=(t,n)=>{const r={x:t,y:n},s=X.add(X.scale(X.subtract(r,a),l),{x:.5*e.width,y:.5*e.height});return{x:s.x,y:e.height-s.y}},u=()=>{let e=!0;for(let r=0;r<t.lineProfile.length;r++){const s=c(t.lineProfileDistanceSum[r],t.lineProfile[r].height);e?(e=!1,n.moveTo(s.x,s.y)):n.lineTo(s.x,s.y)}};n.beginPath(),u();const h=c(0,s),f=c(0,r),d=c(i,r);n.lineTo(d.x,e.height),n.lineTo(f.x,e.height);const m=n.createLinearGradient(0,h.y,0,e.height);m.addColorStop(0,I.lighterAccentColor),m.addColorStop(1,I.backgroundColor),n.fillStyle=m,n.globalAlpha=.5,n.fill(),n.globalAlpha=1,n.beginPath(),u(),n.lineWidth=4,n.lineCap=n.lineJoin="round",n.strokeStyle=I.accentColor,n.stroke(),n.fillStyle=I.darkerAccentColor;for(let e=0;e<t.markerProfile.length;e++){const r=c(t.distanceSum[t.markers[e].index],t.markerProfile[e].height);n.beginPath(),n.arc(r.x,r.y,10,0,2*Math.PI),n.fill()}n.font="bold 14px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillStyle=I.backgroundColor;for(let e=0;e<t.markerProfile.length;e++){const r=c(t.distanceSum[t.markers[e].index],t.markerProfile[e].height);n.fillText(e+1,r.x,r.y+.5)}}(s,r)},[r,s,function(t){k[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class U extends R{constructor(t){super(),G(this,t,K,J,i,{route:1})}}function Z(t,e,n){const r=t.slice();return r[3]=e[n],r}function V(t){let e,n,r,s,i,f,d,p,g,$,v,y,b,k,S,w,C,M,P,q,E,_,H,j,L=Math.round(t[3].diff.height)+"",T=t[3].diff.distance.toFixed(1)+"",z=t[3].diff.effort.toFixed(1)+"",A=Math.round(t[3].diff.time)+"";return{c(){e=c("tr"),n=c("td"),r=h(),s=c("td"),i=h(),f=c("td"),d=u(L),p=h(),g=c("td"),g.textContent="m",$=h(),v=c("td"),y=u(T),b=h(),k=c("td"),k.textContent="km",S=h(),w=c("td"),C=u(z),M=h(),P=c("td"),P.textContent="Lkm",q=h(),E=c("td"),_=u(A),H=h(),j=c("td"),j.textContent="min",m(n,"class","svelte-1usxarx"),m(s,"class","svelte-1usxarx"),m(f,"class","number svelte-1usxarx"),m(g,"class","unit svelte-1usxarx"),m(v,"class","number svelte-1usxarx"),m(k,"class","unit svelte-1usxarx"),m(w,"class","number svelte-1usxarx"),m(P,"class","unit svelte-1usxarx"),m(E,"class","number svelte-1usxarx"),m(j,"class","unit svelte-1usxarx"),m(e,"class","alt svelte-1usxarx")},m(t,l){a(t,e,l),o(e,n),o(e,r),o(e,s),o(e,i),o(e,f),o(f,d),o(e,p),o(e,g),o(e,$),o(e,v),o(v,y),o(e,b),o(e,k),o(e,S),o(e,w),o(w,C),o(e,M),o(e,P),o(e,q),o(e,E),o(E,_),o(e,H),o(e,j)},p(t,e){1&e&&L!==(L=Math.round(t[3].diff.height)+"")&&x(d,L),1&e&&T!==(T=t[3].diff.distance.toFixed(1)+"")&&x(y,T),1&e&&z!==(z=t[3].diff.effort.toFixed(1)+"")&&x(C,z),1&e&&A!==(A=Math.round(t[3].diff.time)+"")&&x(_,A)},d(t){t&&l(e)}}}function Q(t){let e,n,r,s,i,f,d,p,g,$,v,y,b,k,S,w,C,M,P,q,E,_,H,j,L,T,z,A,D,F=t[3].index+"",W=t[3].name+"",G=Math.round(t[3].height)+"",R=t[3].distance.toFixed(1)+"",N=t[3].effort.toFixed(1)+"",O=Math.round(t[3].time)+"",B=t[3].diff&&V(t);return{c(){B&&B.c(),e=h(),n=c("tr"),r=c("td"),s=c("span"),i=u(F),f=h(),d=c("td"),p=u(W),g=h(),$=c("td"),v=u(G),y=h(),b=c("td"),b.textContent="m",k=h(),S=c("td"),w=u(R),C=h(),M=c("td"),M.textContent="km",P=h(),q=c("td"),E=u(N),_=h(),H=c("td"),H.textContent="Lkm",j=h(),L=c("td"),T=u(O),z=h(),A=c("td"),A.textContent="min",D=h(),m(s,"class","svelte-1usxarx"),m(r,"class","index svelte-1usxarx"),m(d,"class","name svelte-1usxarx"),m($,"class","number svelte-1usxarx"),m(b,"class","unit svelte-1usxarx"),m(S,"class","number svelte-1usxarx"),m(M,"class","unit svelte-1usxarx"),m(q,"class","number svelte-1usxarx"),m(H,"class","unit svelte-1usxarx"),m(L,"class","number svelte-1usxarx"),m(A,"class","unit svelte-1usxarx")},m(t,l){B&&B.m(t,l),a(t,e,l),a(t,n,l),o(n,r),o(r,s),o(s,i),o(n,f),o(n,d),o(d,p),o(n,g),o(n,$),o($,v),o(n,y),o(n,b),o(n,k),o(n,S),o(S,w),o(n,C),o(n,M),o(n,P),o(n,q),o(q,E),o(n,_),o(n,H),o(n,j),o(n,L),o(L,T),o(n,z),o(n,A),o(n,D)},p(t,n){t[3].diff?B?B.p(t,n):(B=V(t),B.c(),B.m(e.parentNode,e)):B&&(B.d(1),B=null),1&n&&F!==(F=t[3].index+"")&&x(i,F),1&n&&W!==(W=t[3].name+"")&&x(p,W),1&n&&G!==(G=Math.round(t[3].height)+"")&&x(v,G),1&n&&R!==(R=t[3].distance.toFixed(1)+"")&&x(w,R),1&n&&N!==(N=t[3].effort.toFixed(1)+"")&&x(E,N),1&n&&O!==(O=Math.round(t[3].time)+"")&&x(T,O)},d(t){B&&B.d(t),t&&l(e),t&&l(n)}}}function Y(e){let n,r,s,i=e[0],u=[];for(let t=0;t<i.length;t+=1)u[t]=Q(Z(e,i,t));return{c(){n=c("table"),r=c("tr"),r.innerHTML='<th class="svelte-1usxarx"></th> \n        <th class="svelte-1usxarx">Wegpunkt</th> \n        <th colspan="2" class="svelte-1usxarx">Höhe</th> \n        <th colspan="2" class="svelte-1usxarx">Distanz</th> \n        <th colspan="2" class="svelte-1usxarx">Aufwand</th> \n        <th colspan="2" class="svelte-1usxarx">Zeit</th>',s=h();for(let t=0;t<u.length;t+=1)u[t].c();m(n,"class","svelte-1usxarx")},m(t,e){a(t,n,e),o(n,r),o(n,s);for(let t=0;t<u.length;t+=1)u[t].m(n,null)},p(t,[e]){if(1&e){let r;for(i=t[0],r=0;r<i.length;r+=1){const s=Z(t,i,r);u[r]?u[r].p(s,e):(u[r]=Q(s),u[r].c(),u[r].m(n,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=i.length}},i:t,o:t,d(t){t&&l(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(u,t)}}}function tt(t,e,n){let{route:r}=e,{speed:s}=e,i=[];return t.$$set=t=>{"route"in t&&n(1,r=t.route),"speed"in t&&n(2,s=t.speed)},t.$$.update=()=>{6&t.$$.dirty&&!window.isNaN(s)&&s>0&&n(0,i=function(t,e){const n=[];for(let r=0;r<t.markers.length;r++)n[r]={index:r+1,name:t.markers[r].name,height:t.markerProfile[r].height,distance:t.distanceSum[t.markers[r].index]/1e3,effort:t.effortSum[r],time:t.effortSum[r]/e*60},r>0&&(n[r].diff={height:n[r].height-n[r-1].height,distance:n[r].distance-n[r-1].distance,effort:t.effort[r],time:n[r].time-n[r-1].time});return n}(r,s))},[i,r,s]}class et extends R{constructor(t){super(),G(this,t,tt,Y,i,{route:1,speed:2})}}function nt(e){let n;return{c(){n=c("div"),n.innerHTML='<h1 class="svelte-q9f5fq">Marschzeittabelle<br/>leicht gemacht.</h1> \n    <p class="subtitle svelte-q9f5fq">Wir übertragen deine Route automatisch in eine Marschzeittabelle, damit du dich auf die wichtigen Teile der Planung konzentrieren kannst.</p> \n    <h2 class="svelte-q9f5fq">1. Route planen</h2> \n    <p class="svelte-q9f5fq">Route einzeichnen, Wegpunkte setzen - das kennst du bereits.</p> \n    <h2 class="svelte-q9f5fq">2. Exportieren und hochladen</h2> \n    <p class="svelte-q9f5fq">In wenigen Klicks erledigt.</p> \n    <h2 class="svelte-q9f5fq">3. Voilà!</h2> \n    <p class="svelte-q9f5fq">Schon hast du deine Marschzeittabelle.<br/>Jetzt noch Gewschwindigkeit, Uhrzeit und Pausen anpassen.</p>',m(n,"class","svelte-q9f5fq")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&l(n)}}}class rt extends R{constructor(t){super(),G(this,t,null,nt,i,{})}}function st(t,e,n){const r={type:"LineString",coordinates:t.map((t=>[Math.round(t.x),Math.round(t.y)]))};return fetch(`https://api3.geo.admin.ch/rest/services/profile.json?sr=21781&distinct_points=${e}&nb_points=${n}&geom=${JSON.stringify(r)}`).then((t=>t.json())).then((n=>new Promise((r=>{let s=n.map((t=>({point:{x:t.easting,y:t.northing},height:t.alts.COMB})));e&&(s=s.filter((e=>t.some((t=>X.distance(e.point,t)<2))))),r(s)}))))}class it{constructor(t,e){this.line=t,this.markers=e}async loadProfiles(){this.lineProfile=await st(this.line,!1,100),this.markerProfile=await st(this.markers.map((t=>this.line[t.index])),!0,this.markers.length),this.calculateDistances()}reverse(){this.line.reverse(),this.markers.reverse(),this.markers.forEach((t=>t.index=this.line.length-t.index-1)),this.lineProfile?.reverse(),this.markerProfile?.reverse(),this.calculateDistances()}calculateDistances(){this.distanceSum=ot(this.line),this.lineProfileDistanceSum=ot(this.lineProfile.map((t=>t.point))),this.effort=[],this.effort[0]=0;for(let t=1;t<this.markers.length;t++){const e=this.distanceSum[this.markers[t].index]-this.distanceSum[this.markers[t-1].index],n=this.markerProfile[t].height-this.markerProfile[t-1].height,r=n/e;this.effort[t]=e/1e3,r>0?this.effort[t]+=n/100:r<-.2&&(this.effort[t]+=Math.abs(r)/150)}this.effortSum=at(this.effort)}}function ot(t){return at(t.map(((e,n)=>X.distance(t[Math.max(0,n-1)],t[n]))))}function at(t){const e=[];let n=0;for(let r=0;r<t.length;r++)n+=t[r],e[r]=n;return e}function lt(t){const e=t.split(",").map((t=>Number(t))),n=class{static WGStoCH(t,e){return[this.WGStoCHy(t,e),this.WGStoCHx(t,e)]}static WGStoCHx(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 200147.07+308807.95*n+3745.25*Math.pow(r,2)+76.63*Math.pow(n,2)-194.56*Math.pow(r,2)*n+119.79*Math.pow(n,3)}static WGStoCHy(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 600072.37+211455.93*r-10938.51*r*n-.36*r*Math.pow(n,2)-44.54*Math.pow(r,3)}static CHtoWGS(t,e){return[this.CHtoWGSlng(t,e),this.CHtoWGSlat(t,e)]}static CHtoWGSlat(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(16.9023892+3.238272*r-.270978*Math.pow(n,2)-.002528*Math.pow(r,2)-.0447*Math.pow(n,2)*r-.014*Math.pow(r,3))/36}static CHtoWGSlng(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(2.6779094+4.728982*n+.791484*n*r+.1306*n*Math.pow(r,2)-.0436*Math.pow(n,3))/36}static DECtoSEX(t){const e=parseInt(t),n=parseInt(60*(t-e));return 60*(60*(t-e)-n)+60*n+3600*e}}.WGStoCH(e[1],e[0]);return{x:n[0],y:n[1]}}function ct(t){const e=(t,e)=>X.distance(t,e)<2;for(let n=0;n<t.length;n++)for(let r=n+1;r<t.length;r++){if(e(t[n][t[n].length-1],t[r][0]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!1};if(e(t[n][0],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!0};if(e(t[n][0],t[r][0]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!1};if(e(t[n][t[n].length-1],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!0}}return null}function ut(e){let n;return{c(){n=c("h3"),n.textContent="Route wird gewandert..."},m(t,e){a(t,n,e)},p:t,d(t){t&&l(n)}}}function ht(e){let n,r,s,i,o,u,d,p,x,g,$,v,y;return{c(){n=c("h2"),n.textContent="Route hochladen",r=h(),s=c("p"),s.innerHTML='Unterstützt sind Exporte im <b>KML-Format</b> von <a href="https://map.geo.admin.ch" target="_blank">map.geo.admin.ch</a> oder der <a href="https://www.swisstopo.admin.ch/en/maps-data-online/maps-geodata-online/swisstopo-app.html" target="_blank">swisstopo-App</a>.',i=h(),o=c("p"),o.textContent="Datei hierher ziehen oder...",u=h(),d=c("input"),p=h(),x=c("button"),x.innerHTML='<label for="upload" class="svelte-krr8rg">Datei auswählen</label>',g=h(),$=c("br"),m(d,"type","file"),m(d,"id","upload"),m(d,"accept",".kml"),m(d,"class","svelte-krr8rg")},m(t,l){a(t,n,l),a(t,r,l),a(t,s,l),a(t,i,l),a(t,o,l),a(t,u,l),a(t,d,l),a(t,p,l),a(t,x,l),a(t,g,l),a(t,$,l),v||(y=f(d,"change",e[3]),v=!0)},p:t,d(t){t&&l(n),t&&l(r),t&&l(s),t&&l(i),t&&l(o),t&&l(u),t&&l(d),t&&l(p),t&&l(x),t&&l(g),t&&l($),v=!1,y()}}}function ft(e){let n,s,i;function o(t,e){return t[0]&&t[0][0]?ut:ht}let u=o(e),h=u(e);return{c(){n=c("div"),h.c(),m(n,"class","svelte-krr8rg")},m(t,r){a(t,n,r),h.m(n,null),s||(i=[f(n,"drop",d(e[4])),f(n,"dragover",d(e[2]))],s=!0)},p(t,[e]){u===(u=o(t))&&h?h.p(t,e):(h.d(1),h=u(t),h&&(h.c(),h.m(n,null)))},i:t,o:t,d(t){t&&l(n),h.d(),s=!1,r(i)}}}function dt(t,e,n){let r,{route:s=null}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{if(1&t.$$.dirty&&r&&r[0]){const t=new FileReader;t.addEventListener("load",(()=>{const e=function(t){const e=[],n=[],r=(new DOMParser).parseFromString(t,"application/xml").querySelectorAll("Placemark");for(let t of r){if(t.querySelector("LineString")){const n=t.querySelector("LineString coordinates").innerHTML.trim().split(" ").map((t=>lt(t)));e.push(n)}if(t.querySelector("Point")){const e=t.querySelector("name").innerHTML.trim(),r=lt(t.querySelector("Point coordinates").innerHTML);n.push({name:e,point:r})}}for(;e.length>1;){const t=ct(e);if(null==t)return void console.error("Lines are not connected");t.reverseFirst&&e[t.i].reverse(),t.reverseSecond&&e[t.j].reverse(),e[t.i].push(...e[t.j]),e.splice(t.j,1)}const s=e[0];for(let t of n){let e=0,n=1/0;for(let r=0;r<s.length;r++){const i=X.distance(t.point,s[r]);i<n&&(e=r,n=i)}t.index=e,delete t.point}return n.sort(((t,e)=>t.index-e.index)),new it(s,n)}(t.result);e.loadProfiles().then((()=>n(1,s=e)))})),t.readAsText(r[0])}},[r,s,function(e){y.call(this,t,e)},function(){r=this.files,n(0,r)},t=>n(0,r=t.dataTransfer.files)]}class mt extends R{constructor(t){super(),G(this,t,dt,ft,i,{route:1})}}function pt(t){let e,n,r,s,i;function o(e){t[4](e)}e=new rt({});let c={};return void 0!==t[0]&&(c.route=t[0]),r=new mt({props:c}),k.push((()=>function(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}(r,"route",o))),{c(){A(e.$$.fragment),n=h(),A(r.$$.fragment)},m(t,s){D(e,t,s),a(t,n,s),D(r,t,s),i=!0},p(t,e){const n={};var i;!s&&1&e&&(s=!0,n.route=t[0],i=()=>s=!1,w.push(i)),r.$set(n)},i(t){i||(T(e.$$.fragment,t),T(r.$$.fragment,t),i=!0)},o(t){z(e.$$.fragment,t),z(r.$$.fragment,t),i=!1},d(t){F(e,t),t&&l(n),F(r,t)}}}function xt(t){let e,n,s,i,u,d,x,$,v,y,b,k,S,w,C,M,P,q,E,_,H,j,L,W,G,R,N,O,X,I,J,K,Z,V,Q,Y;return d=new B({props:{route:t[0]}}),O=new et({props:{route:t[0],speed:t[1]}}),Z=new U({props:{route:t[0]}}),{c(){e=c("div"),n=c("div"),s=c("div"),i=c("h2"),i.textContent="Route",u=h(),A(d.$$.fragment),x=h(),$=c("div"),v=c("h2"),v.textContent="Optionen",y=h(),b=c("label"),b.textContent="Geschwindigkeit in Lkm/h",k=h(),S=c("input"),w=h(),C=c("br"),M=h(),P=c("button"),P.textContent="Richtung wechseln",q=h(),E=c("br"),_=h(),H=c("br"),j=h(),L=c("button"),L.textContent="Herunterladen",W=h(),G=c("div"),R=c("h2"),R.textContent="Marschzeittabelle",N=h(),A(O.$$.fragment),X=h(),I=c("div"),J=c("h2"),J.textContent="Höhenprofil",K=h(),A(Z.$$.fragment),m(s,"class","info"),m(b,"for","speed"),m(b,"class","svelte-h4umcj"),m(S,"id","speed"),m(S,"type","number"),m(S,"min","0.5"),m(S,"step","0.5"),m(S,"class","svelte-h4umcj"),m(P,"class","secondary"),m($,"class","options svelte-h4umcj"),m(n,"class","general svelte-h4umcj"),m(G,"class","table svelte-h4umcj"),m(I,"class","profile svelte-h4umcj"),m(e,"class","editor")},m(r,l){a(r,e,l),o(e,n),o(n,s),o(s,i),o(s,u),D(d,s,null),o(n,x),o(n,$),o($,v),o($,y),o($,b),o($,k),o($,S),g(S,t[1]),o($,w),o($,C),o($,M),o($,P),o($,q),o($,E),o($,_),o($,H),o($,j),o($,L),o(e,W),o(e,G),o(G,R),o(G,N),D(O,G,null),o(e,X),o(e,I),o(I,J),o(I,K),D(Z,I,null),V=!0,Q||(Y=[f(S,"input",t[3]),f(P,"click",t[2]),f(L,"click",$t)],Q=!0)},p(t,e){const n={};1&e&&(n.route=t[0]),d.$set(n),2&e&&p(S.value)!==t[1]&&g(S,t[1]);const r={};1&e&&(r.route=t[0]),2&e&&(r.speed=t[1]),O.$set(r);const s={};1&e&&(s.route=t[0]),Z.$set(s)},i(t){V||(T(d.$$.fragment,t),T(O.$$.fragment,t),T(Z.$$.fragment,t),V=!0)},o(t){z(d.$$.fragment,t),z(O.$$.fragment,t),z(Z.$$.fragment,t),V=!1},d(t){t&&l(e),F(d),F(O),F(Z),Q=!1,r(Y)}}}function gt(t){let e,n,s,i,o,u,f,d;const p=[xt,pt],x=[];function g(t,e){return t[0]?0:1}return i=g(t),o=x[i]=p[i](t),{c(){e=c("header"),e.innerHTML='<span><a href="">startseite</a></span> \n    <span><a href="#">über diese seite</a> |\n        <a href="#">faq</a> |\n        <a href="https://github.com/ckolin/marschzeittabelle">github</a></span>',n=h(),s=c("main"),o.c(),u=h(),f=c("footer"),f.textContent="marschzeittabelle.ch",m(e,"class","svelte-h4umcj"),m(f,"class","svelte-h4umcj")},m(t,r){a(t,e,r),a(t,n,r),a(t,s,r),x[i].m(s,null),a(t,u,r),a(t,f,r),d=!0},p(t,[e]){let n=i;i=g(t),i===n?x[i].p(t,e):(L={r:0,c:[],p:L},z(x[n],1,1,(()=>{x[n]=null})),L.r||r(L.c),L=L.p,o=x[i],o?o.p(t,e):(o=x[i]=p[i](t),o.c()),T(o,1),o.m(s,null))},i(t){d||(T(o),d=!0)},o(t){z(o),d=!1},d(t){t&&l(e),t&&l(n),t&&l(s),x[i].d(),t&&l(u),t&&l(f)}}}function $t(){window.print()}function vt(t,e,n){let r,s=4;for(let t of Object.keys(I)){const e="--"+t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));document.documentElement.style.setProperty(e,I[t])}return[r,s,function(){r.reverse(),n(0,r)},function(){s=p(this.value),n(1,s)},function(t){r=t,n(0,r)}]}return new class extends R{constructor(t){super(),G(this,t,vt,gt,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
