var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let s;function c(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}const a="undefined"!=typeof window;let u=a?()=>window.performance.now():()=>Date.now(),d=a?t=>requestAnimationFrame(t):t;const f=new Set;function h(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&d(h)}function m(t,e){t.appendChild(e)}function p(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function $(t){const e=k("style");return function(t,e){m(t.head||t,e)}(p(t),e),e.sheet}function g(t,e,n){t.insertBefore(e,n||null)}function b(t){t.parentNode.removeChild(t)}function k(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function v(){return w(" ")}function x(){return w("")}function y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function S(t){return function(e){return e.preventDefault(),t.call(this,e)}}function C(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function M(t){return""===t?null:+t}function E(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function P(t,e){t.value=null==e?"":e}function A(t,e,n){t.classList[n?"add":"remove"](e)}function L(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}const _=new Map;let j,D=0;function F(t,e,n,r,o,i,l,s=0){const c=16.666/r;let a="{\n";for(let t=0;t<=1;t+=c){const r=e+(n-e)*i(t);a+=100*t+`%{${l(r,1-r)}}\n`}const u=a+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${s}`,f=p(t),{stylesheet:h,rules:m}=_.get(f)||function(t,e){const n={stylesheet:$(e),rules:{}};return _.set(t,n),n}(f,t);m[d]||(m[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${d} ${r}ms linear ${o}ms 1 both`,D+=1,d}function H(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=n.length-r.length;o&&(t.style.animation=r.join(", "),D-=o,D||d((()=>{D||(_.forEach((t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}})),_.clear())})))}function T(t){j=t}function z(){if(!j)throw new Error("Function called outside component initialization");return j}function W(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const G=[],N=[],R=[],q=[],B=Promise.resolve();let O=!1;function U(t){R.push(t)}function I(t){q.push(t)}const X=new Set;let K,J=0;function V(){const t=j;do{for(;J<G.length;){const t=G[J];J++,T(t),Z(t.$$)}for(T(null),G.length=0,J=0;N.length;)N.pop()();for(let t=0;t<R.length;t+=1){const e=R[t];X.has(e)||(X.add(e),e())}R.length=0}while(G.length);for(;q.length;)q.pop()();O=!1,X.clear(),T(t)}function Z(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(U)}}function Q(t,e,n){t.dispatchEvent(L(`${e?"intro":"outro"}${n}`))}const Y=new Set;let tt;function et(){tt={r:0,c:[],p:tt}}function nt(){tt.r||o(tt.c),tt=tt.p}function rt(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function ot(t,e,n,r){if(t&&t.o){if(Y.has(t))return;Y.add(t),tt.c.push((()=>{Y.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const it={duration:0};function lt(n,r,l,s){let c=r(n,l),a=s?0:1,m=null,p=null,$=null;function g(){$&&H(n,$)}function b(t,e){const n=t.b-a;return e*=Math.abs(n),{a:a,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function k(r){const{delay:i=0,duration:l=300,easing:s=e,tick:k=t,css:w}=c||it,v={start:u()+i,b:r};r||(v.group=tt,tt.r+=1),m||p?p=v:(w&&(g(),$=F(n,a,r,l,i,s,w)),r&&k(0,1),m=b(v,l),U((()=>Q(n,r,"start"))),function(t){let e;0===f.size&&d(h),new Promise((n=>{f.add(e={c:t,f:n})}))}((t=>{if(p&&t>p.start&&(m=b(p,l),p=null,Q(n,m.b,"start"),w&&(g(),$=F(n,a,m.b,m.duration,0,s,c.css))),m)if(t>=m.end)k(a=m.b,1-a),Q(n,m.b,"end"),p||(m.b?g():--m.group.r||o(m.group.c)),m=null;else if(t>=m.start){const e=t-m.start;a=m.a+m.d*s(e/m.duration),k(a,1-a)}return!(!m&&!p)})))}return{run(t){i(c)?(K||(K=Promise.resolve(),K.then((()=>{K=null}))),K).then((()=>{c=c(),k(t)})):k(t)},end(){g(),m=p=null}}}function st(t,e){const n=e.token={};function r(t,r,o,i){if(e.token!==n)return;e.resolved=i;let l=e.ctx;void 0!==o&&(l=l.slice(),l[o]=i);const s=t&&(e.current=t)(l);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(et(),ot(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),nt())})):e.block.d(1),s.c(),rt(s,1),s.m(e.mount(),e.anchor),c=!0),e.block=s,e.blocks&&(e.blocks[r]=s),c&&V()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=z();if(t.then((t=>{T(n),r(e.then,1,e.value,t),T(null)}),(t=>{if(T(n),r(e.catch,2,e.error,t),T(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function ct(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function at(t){t&&t.c()}function ut(t,e,r,l){const{fragment:s,on_mount:c,on_destroy:a,after_update:u}=t.$$;s&&s.m(e,r),l||U((()=>{const e=c.map(n).filter(i);a?a.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(U)}function dt(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ft(t,e){-1===t.$$.dirty[0]&&(G.push(t),O||(O=!0,B.then(V)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ht(e,n,i,l,s,c,a,u=[-1]){const d=j;T(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:s,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(f.root);let h=!1;if(f.ctx=i?i(e,n.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),h&&ft(e,t)),n})):[],f.update(),h=!0,o(f.before_update),f.fragment=!!l&&l(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(b)}else f.fragment&&f.fragment.c();n.intro&&rt(e.$$.fragment),ut(e,n.target,n.anchor,n.customElement),V()}T(d)}class mt{$destroy(){dt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function pt(t){const e=t-1;return e*e*e+1}function $t(t,{delay:n=0,duration:r=400,easing:o=e}={}){const i=+getComputedStyle(t).opacity;return{delay:n,duration:r,easing:o,css:t=>"opacity: "+t*i}}function gt(t,{delay:e=0,duration:n=400,easing:r=pt}={}){const o=getComputedStyle(t),i=+o.opacity,l=parseFloat(o.height),s=parseFloat(o.paddingTop),c=parseFloat(o.paddingBottom),a=parseFloat(o.marginTop),u=parseFloat(o.marginBottom),d=parseFloat(o.borderTopWidth),f=parseFloat(o.borderBottomWidth);return{delay:e,duration:n,easing:r,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*i};height: ${t*l}px;padding-top: ${t*s}px;padding-bottom: ${t*c}px;margin-top: ${t*a}px;margin-bottom: ${t*u}px;border-top-width: ${t*d}px;border-bottom-width: ${t*f}px;`}}function bt(e){let n,r;return{c(){n=k("span"),r=w(e[0]),C(n,"class","material-icons svelte-rsldo3")},m(t,e){g(t,n,e),m(n,r)},p(t,[e]){1&e&&E(r,t[0])},i:t,o:t,d(t){t&&b(n)}}}function kt(t,e,n){let{name:r}=e;return t.$$set=t=>{"name"in t&&n(0,r=t.name)},[r]}class wt extends mt{constructor(t){super(),ht(this,t,kt,bt,l,{name:0})}}function vt(e){let n,r,o,i;return{c(){n=k("a"),r=k("button"),o=w(e[1]),C(r,"class","pill"),C(n,"class","noprint"),C(n,"href",i=null==e[0]?"help":`help#${e[0]}`),C(n,"target","_blank"),C(n,"tabindex","-1")},m(t,e){g(t,n,e),m(n,r),m(r,o)},p(t,[e]){2&e&&E(o,t[1]),1&e&&i!==(i=null==t[0]?"help":`help#${t[0]}`)&&C(n,"href",i)},i:t,o:t,d(t){t&&b(n)}}}function xt(t,e,n){let{topic:r=null}=e,{label:o="?"}=e;return t.$$set=t=>{"topic"in t&&n(0,r=t.topic),"label"in t&&n(1,o=t.label)},[r,o]}class yt extends mt{constructor(t){super(),ht(this,t,xt,vt,l,{topic:0,label:1})}}function St(t){let e,n,r,o,i,l,s,a,u,d,f,h,p,$,x,M;const P=t[4].default,A=function(t,e,n,r){if(t){const o=c(t,e,n,r);return t[0](o)}}(P,t,t[3],null);return f=new wt({props:{name:"done"}}),{c(){e=k("div"),n=k("div"),r=k("h2"),o=w(t[1]),i=v(),l=k("form"),A&&A.c(),s=v(),a=k("br"),u=v(),d=k("button"),at(f.$$.fragment),h=w(" Fertig"),C(r,"class","svelte-83usvd"),C(d,"class","svelte-83usvd"),C(n,"class","dialog svelte-83usvd"),C(e,"class","background svelte-83usvd")},m(c,p){g(c,e,p),m(e,n),m(n,r),m(r,o),m(n,i),m(n,l),A&&A.m(l,null),m(l,s),m(l,a),m(l,u),m(l,d),ut(f,d,null),m(d,h),$=!0,x||(M=y(l,"submit",S(t[2])),x=!0)},p(t,e){(!$||2&e)&&E(o,t[1]),A&&A.p&&(!$||8&e)&&function(t,e,n,r,o,i){if(o){const l=c(e,n,r,i);t.p(l,o)}}(A,P,t,t[3],$?function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(P,t[3],e,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[3]),null)},i(t){$||(rt(A,t),rt(f.$$.fragment,t),U((()=>{p||(p=lt(e,$t,{duration:100},!0)),p.run(1)})),$=!0)},o(t){ot(A,t),ot(f.$$.fragment,t),p||(p=lt(e,$t,{duration:100},!1)),p.run(0),$=!1},d(t){t&&b(e),A&&A.d(t),dt(f),t&&p&&p.end(),x=!1,M()}}}function Ct(t){let e,n,r=t[0]&&St(t);return{c(){r&&r.c(),e=x()},m(t,o){r&&r.m(t,o),g(t,e,o),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&rt(r,1)):(r=St(t),r.c(),rt(r,1),r.m(e.parentNode,e)):r&&(et(),ot(r,1,1,(()=>{r=null})),nt())},i(t){n||(rt(r),n=!0)},o(t){ot(r),n=!1},d(t){r&&r.d(t),t&&b(e)}}}function Mt(t,e,n){let{$$slots:r={},$$scope:o}=e,{title:i}=e,{show:l=!1}=e;const s=function(){const t=z();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=L(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}();return t.$$set=t=>{"title"in t&&n(1,i=t.title),"show"in t&&n(0,l=t.show),"$$scope"in t&&n(3,o=t.$$scope)},[l,i,function(){n(0,l=!1),s("close")},o,r]}class Et extends mt{constructor(t){super(),ht(this,t,Mt,Ct,l,{title:1,show:0})}}function Pt(t){const{h:e,m:n}=Lt(t);return`${e}:${_t(n)}`}function At(t){const{h:e,m:n}=Lt(t);return`${_t(e%24)}:${_t(n)}`}function Lt(t){const e=Math.floor(t);return{h:e,m:Math.floor(60*(t-e))}}function _t(t){return t<10?`0${t}`:t.toString()}function jt(t,e){return t.x===e.x&&t.y===e.y}function Dt(t,e){return n=function(t,e){return{x:t.x-e.x,y:t.y-e.y}}(e,t),Math.hypot(n.x,n.y);var n}function Ft(t,e,n){const r={type:"LineString",coordinates:t.map((t=>[Math.round(t.x),Math.round(t.y)]))};return fetch("https://api3.geo.admin.ch/rest/services/profile.json",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`sr=21781&distinct_points=${e}&nb_points=${n}&geom=${JSON.stringify(r)}`}).then((t=>{if(t.ok)return t.json();throw"Das Höhenprofil konnte nicht geladen werden."})).then((n=>new Promise((r=>{let o=n.map((t=>({point:{x:t.easting,y:t.northing},height:t.alts.COMB})));e&&(o=o.filter((e=>t.some((t=>Dt(e.point,t)<2))))),r(o)})))).catch((()=>{throw"Die Verbindung zu den swisstopo-Servern ist fehlgeschlagen."}))}function Ht(t){t.distanceSum=Tt(t.line),t.lineProfileDistanceSum=Tt(t.lineProfile.map((t=>t.point))),t.effort=function(t){const e=[];e[0]=0;for(let n=1;n<t.markers.length;n++){const r=t.distanceSum[t.markers[n].index]-t.distanceSum[t.markers[n-1].index],o=t.markerProfile[n].height-t.markerProfile[n-1].height,i=o/r;e[n]=r/1e3,i>0?e[n]+=o/100:i<-.2&&(e[n]+=Math.abs(o)/150)}return e}(t),t.effortSum=zt(t.effort),t.breakSum=[0,...zt(t.markers.map((t=>t.break)))]}function Tt(t){return zt(t.map(((e,n)=>Dt(t[Math.max(0,n-1)],t[n]))))}function zt(t){const e=[];let n=0;for(let r=0;r<t.length;r++)n+=t[r],e[r]=n;return e}function Wt(t){const e=[];for(let n=0;n<t.markers.length;n++)e[n]={index:n,name:t.markers[n].name,comment:t.markers[n].comment,height:t.markerProfile[n].height,distance:t.distanceSum[t.markers[n].index]/1e3,effort:t.effortSum[n],duration:t.effortSum[n]/t.speed,time:t.effortSum[n]/t.speed+t.breakSum[n]/60+t.start,break:t.markers[n].break};for(let n=1;n<t.markers.length;n++)e[n-1].diff={height:e[n].height-e[n-1].height,distance:e[n].distance-e[n-1].distance,effort:t.effort[n],duration:e[n].duration-e[n-1].duration};return e}function Gt(t){let e,n,r,o,i;return{c(){e=k("label"),e.textContent="Geschwindigkeit (Lkm/h)",n=v(),r=k("input"),C(e,"for","speed"),C(r,"id","speed"),C(r,"class","stretch"),C(r,"type","number"),C(r,"min","0.5"),C(r,"step","0.5"),r.required=!0},m(l,s){g(l,e,s),g(l,n,s),g(l,r,s),P(r,t[1]),o||(i=y(r,"input",t[8]),o=!0)},p(t,e){2&e&&M(r.value)!==t[1]&&P(r,t[1])},d(t){t&&b(e),t&&b(n),t&&b(r),o=!1,i()}}}function Nt(t){let e,n,r,o,i;return{c(){e=k("label"),e.textContent="Abreise",n=v(),r=k("input"),C(e,"for","start"),C(r,"id","start"),C(r,"class","stretch"),C(r,"type","time"),r.required=!0},m(l,s){g(l,e,s),g(l,n,s),g(l,r,s),P(r,t[2]),o||(i=y(r,"input",t[10]),o=!0)},p(t,e){4&e&&P(r,t[2])},d(t){t&&b(e),t&&b(n),t&&b(r),o=!1,i()}}}function Rt(t){let e,n,r,i,l,s,c,a,u,d,f,h,p,$,x,S,M,P,A,L,_,j,D,F,H,T,z,W,G,R,q,B,O,U,X,K,J,V,Z,Q,Y,tt,et,nt,it,lt,st,ft,ht,mt,pt,$t,gt,bt,kt,vt,xt,St,Ct,Mt,Lt,_t,jt,Dt,Ft,Ht,Tt,zt,Wt,Rt,qt,Bt,Ot,Ut,It,Xt,Kt,Jt,Vt,Zt,Qt,Yt,te,ee,ne,re,oe,ie=t[0].markers[0].name+"",le=t[0].markers[t[0].markers.length-1].name+"",se=t[5].distance.toFixed(1)+"",ce=Math.round(t[5].ascent)+"",ae=Math.round(t[5].descent)+"",ue=t[5].effort.toFixed(1)+"",de=t[0].speed+"",fe=At(t[0].start)+"",he=At(t[0].start+t[5].duration)+"",me=Pt(t[5].duration)+"",pe=Pt(t[5].breakDuration)+"";function $e(e){t[9](e)}let ge={title:"Geschwindigkeit anpassen",$$slots:{default:[Gt]},$$scope:{ctx:t}};function be(e){t[11](e)}void 0!==t[3]&&(ge.show=t[3]),e=new Et({props:ge}),N.push((()=>ct(e,"show",$e)));let ke={title:"Abreise anpassen",$$slots:{default:[Nt]},$$scope:{ctx:t}};return void 0!==t[4]&&(ke.show=t[4]),i=new Et({props:ke}),N.push((()=>ct(i,"show",be))),A=new wt({props:{name:"swap_vert"}}),tt=new yt({props:{topic:"calculation"}}),mt=new wt({props:{name:"edit"}}),St=new wt({props:{name:"edit"}}),Vt=new wt({props:{name:"print"}}),te=new wt({props:{name:"output"}}),{c(){at(e.$$.fragment),r=v(),at(i.$$.fragment),s=v(),c=k("div"),a=k("div"),u=k("p"),d=w("Start: "),f=k("b"),h=w(ie),p=k("br"),$=w("\r\n            Ziel: "),x=k("b"),S=w(le),M=v(),P=k("button"),at(A.$$.fragment),L=w(" Richtung wechseln"),_=v(),j=k("div"),D=w("Horizontaldistanz: "),F=k("b"),H=w(se),T=w(" km"),z=k("br"),W=w("\r\n        Auf-/Abstieg: ↑ "),G=k("b"),R=w(ce),q=w(" m"),B=w(" ↓ "),O=k("b"),U=w(ae),X=w(" m"),K=k("br"),J=w("\r\n        Aufwand: "),V=k("b"),Z=w(ue),Q=w(" Lkm"),Y=v(),at(tt.$$.fragment),et=k("br"),nt=w("\r\n        Geschwindigkeit: "),it=k("b"),lt=w(de),st=w(" Lkm/h"),ft=v(),ht=k("button"),at(mt.$$.fragment),pt=v(),$t=k("div"),gt=w("Abreise: "),bt=k("b"),kt=w(fe),vt=v(),xt=k("button"),at(St.$$.fragment),Ct=v(),Mt=k("br"),Lt=w("\r\n        Ankunft: "),_t=k("b"),jt=w(he),Dt=k("br"),Ft=w("\r\n        Gehzeit: "),Ht=k("b"),Tt=w(me),zt=w(" h"),Wt=k("br"),Rt=w("\r\n        Pausen: "),qt=k("b"),Bt=w(pe),Ot=w(" h"),Ut=v(),It=k("div"),Xt=k("br"),Kt=v(),Jt=k("button"),at(Vt.$$.fragment),Zt=w(" Drucken"),Qt=w("\r\n     \r\n    "),Yt=k("button"),at(te.$$.fragment),ee=w(" Exportieren (CSV)"),C(u,"class","svelte-1crre34"),C(P,"class","pill noprint"),C(a,"class","svelte-1crre34"),C(ht,"class","pill noprint"),C(j,"class","svelte-1crre34"),C(xt,"class","pill noprint"),C($t,"class","svelte-1crre34"),C(c,"class","container svelte-1crre34"),C(Yt,"class","secondary"),C(It,"class","noprint")},m(n,o){ut(e,n,o),g(n,r,o),ut(i,n,o),g(n,s,o),g(n,c,o),m(c,a),m(a,u),m(u,d),m(u,f),m(f,h),m(u,p),m(u,$),m(u,x),m(x,S),m(a,M),m(a,P),ut(A,P,null),m(P,L),m(c,_),m(c,j),m(j,D),m(j,F),m(F,H),m(F,T),m(j,z),m(j,W),m(j,G),m(G,R),m(G,q),m(j,B),m(j,O),m(O,U),m(O,X),m(j,K),m(j,J),m(j,V),m(V,Z),m(V,Q),m(j,Y),ut(tt,j,null),m(j,et),m(j,nt),m(j,it),m(it,lt),m(it,st),m(j,ft),m(j,ht),ut(mt,ht,null),m(c,pt),m(c,$t),m($t,gt),m($t,bt),m(bt,kt),m($t,vt),m($t,xt),ut(St,xt,null),m($t,Ct),m($t,Mt),m($t,Lt),m($t,_t),m(_t,jt),m($t,Dt),m($t,Ft),m($t,Ht),m(Ht,Tt),m(Ht,zt),m($t,Wt),m($t,Rt),m($t,qt),m(qt,Bt),m(qt,Ot),g(n,Ut,o),g(n,It,o),m(It,Xt),m(It,Kt),m(It,Jt),ut(Vt,Jt,null),m(Jt,Zt),m(It,Qt),m(It,Yt),ut(te,Yt,null),m(Yt,ee),ne=!0,re||(oe=[y(P,"click",t[6]),y(ht,"click",t[12]),y(xt,"click",t[13]),y(Jt,"click",t[14]),y(Yt,"click",t[7])],re=!0)},p(t,[r]){const o={};32770&r&&(o.$$scope={dirty:r,ctx:t}),!n&&8&r&&(n=!0,o.show=t[3],I((()=>n=!1))),e.$set(o);const s={};32772&r&&(s.$$scope={dirty:r,ctx:t}),!l&&16&r&&(l=!0,s.show=t[4],I((()=>l=!1))),i.$set(s),(!ne||1&r)&&ie!==(ie=t[0].markers[0].name+"")&&E(h,ie),(!ne||1&r)&&le!==(le=t[0].markers[t[0].markers.length-1].name+"")&&E(S,le),(!ne||32&r)&&se!==(se=t[5].distance.toFixed(1)+"")&&E(H,se),(!ne||32&r)&&ce!==(ce=Math.round(t[5].ascent)+"")&&E(R,ce),(!ne||32&r)&&ae!==(ae=Math.round(t[5].descent)+"")&&E(U,ae),(!ne||32&r)&&ue!==(ue=t[5].effort.toFixed(1)+"")&&E(Z,ue),(!ne||1&r)&&de!==(de=t[0].speed+"")&&E(lt,de),(!ne||1&r)&&fe!==(fe=At(t[0].start)+"")&&E(kt,fe),(!ne||33&r)&&he!==(he=At(t[0].start+t[5].duration)+"")&&E(jt,he),(!ne||32&r)&&me!==(me=Pt(t[5].duration)+"")&&E(Tt,me),(!ne||32&r)&&pe!==(pe=Pt(t[5].breakDuration)+"")&&E(Bt,pe)},i(t){ne||(rt(e.$$.fragment,t),rt(i.$$.fragment,t),rt(A.$$.fragment,t),rt(tt.$$.fragment,t),rt(mt.$$.fragment,t),rt(St.$$.fragment,t),rt(Vt.$$.fragment,t),rt(te.$$.fragment,t),ne=!0)},o(t){ot(e.$$.fragment,t),ot(i.$$.fragment,t),ot(A.$$.fragment,t),ot(tt.$$.fragment,t),ot(mt.$$.fragment,t),ot(St.$$.fragment,t),ot(Vt.$$.fragment,t),ot(te.$$.fragment,t),ne=!1},d(t){dt(e,t),t&&b(r),dt(i,t),t&&b(s),t&&b(c),dt(A),dt(tt),dt(mt),dt(St),t&&b(Ut),t&&b(It),dt(Vt),dt(te),re=!1,o(oe)}}}function qt(t,e,n){let r,{route:o}=e,i=!1,l=o.speed,s=!1,c=At(o.start);return t.$$set=t=>{"route"in t&&n(0,o=t.route)},t.$$.update=()=>{2&t.$$.dirty&&!window.isNaN(l)&&l>0&&n(0,o.speed=l,o),4&t.$$.dirty&&n(0,o.start=c.split(":").map(((t,e)=>Number(t)/60**e)).reduce(((t,e)=>t+e)),o),1&t.$$.dirty&&n(5,r=function(t){const e=t.distanceSum[t.line.length-1]/1e3,n=t.effortSum[t.markers.length-1],r=n/t.speed,o=t.breakSum[t.markers.length-1]/60,i=r+o,{ascent:l,descent:s}=function(t){let e=0,n=0;for(let r=1;r<t.markers.length;r++){const o=t.markerProfile[r].height-t.markerProfile[r-1].height;o>0?e+=o:n-=o}return{ascent:e,descent:n}}(t);return{distance:e,effort:n,walkingDuration:r,breakDuration:o,duration:i,ascent:l,descent:s}}(o))},[o,l,c,i,s,r,function(){!function(t){t.line.reverse(),t.markers.reverse(),t.lineProfile?.reverse(),t.markerProfile?.reverse(),t.markers.forEach((e=>e.index=t.line.length-e.index-1)),Ht(t)}(o),n(0,o),n(1,l),n(2,c)},function(){const t=[["Nr.","Name","Kommentar","Höhe / m","Unterschied Höhe / m","Total Distanz / km","Unterschied Distanz / km","Total Aufwand / Lkm","Unterschied Aufwand / Lkm","Total Gehzeit / h","Unterschied Gehzeit / h","Uhrzeit / hh:mm","Pausen / min"],...Wt(o).map((t=>[t.index+1,t.name,t.comment??"",t.height,t.diff?.height??0,t.distance,t.diff?.distance??0,t.effort,t.diff?.effort??0,t.duration,t.diff?.duration??0,At(t.time),t.break]))].map((t=>t.map((t=>`"${t}"`)).join(","))).join("\n"),e=document.createElement("a");e.href=URL.createObjectURL(new Blob([t],{type:"text/csv"})),e.download="marschzeittabelle.csv",e.click()},function(){l=M(this.value),n(1,l)},function(t){i=t,n(3,i)},function(){c=this.value,n(2,c)},function(t){s=t,n(4,s)},()=>n(3,i=!0),()=>n(4,s=!0),()=>window.print()]}class Bt extends mt{constructor(t){super(),ht(this,t,qt,Rt,l,{route:0})}}function Ot(){for(let t of Object.keys(Ut)){const e="--"+t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));Ut[t]=window.getComputedStyle(document.body).getPropertyValue(e)}return Ut}const Ut={backgroundColor:null,textColor:null,darkerAccentColor:null,accentColor:null,lighterAccentColor:null,shadowColor:null};function It(e){let n;return{c(){n=k("canvas"),C(n,"class","svelte-xd84ci")},m(t,r){g(t,n,r),e[2](n)},p:t,i:t,o:t,d(t){t&&b(n),e[2](null)}}}function Xt(t,e,n){let r,{route:o}=e;return t.$$set=t=>{"route"in t&&n(1,o=t.route)},t.$$.update=()=>{3&t.$$.dirty&&r&&(n(0,r.width=800,r),n(0,r.height=200,r),function(t,e){const n=Ot(),r=e.getContext("2d");r.clearRect(0,0,e.width,e.height);const o=12;let i=1/0,l=-1/0;for(let e of t.lineProfile)i=Math.min(i,e.height),l=Math.max(l,e.height);const s={x:t.distanceSum[t.distanceSum.length-1],y:l-i},c=Math.min((e.width-24)/s.x,(e.height-24-40)/s.y);e.width=Math.floor(s.x*c+24),e.height=Math.floor(s.y*c+24+40);const a=(t,n)=>{return r={x:(s={x:t,y:i-n}).x*(a=c),y:s.y*a},l={x:o,y:e.height-o-40},{x:r.x+l.x,y:r.y+l.y};var r,l,s,a},u=()=>{for(let e=0;e<t.lineProfile.length;e++){const n=a(t.lineProfileDistanceSum[e],t.lineProfile[e].height);0===e?r.moveTo(n.x,n.y):r.lineTo(n.x,n.y)}};r.beginPath(),u();const d=a(0,l),f=a(0,i),h=a(s.x,i);r.lineTo(h.x,e.height),r.lineTo(f.x,e.height);const m=r.createLinearGradient(0,d.y,0,e.height);m.addColorStop(0,n.lighterAccentColor),m.addColorStop(1,n.backgroundColor),r.fillStyle=m,r.fill(),r.beginPath(),u(),r.lineWidth=4,r.lineCap=r.lineJoin="round",r.strokeStyle=n.accentColor,r.stroke(),r.font="bold 14px sans-serif",r.textAlign="center",r.textBaseline="middle";for(let e=0;e<t.markerProfile.length;e++){const o=a(t.distanceSum[t.markers[e].index],t.markerProfile[e].height);r.beginPath(),r.arc(o.x,o.y,10,0,2*Math.PI),r.fillStyle=n.darkerAccentColor,r.fill(),r.fillStyle=n.backgroundColor,r.fillText(e+1,o.x,o.y+.5)}const p=125*2**Math.floor(Math.log2(120/(125*c))),$=p*c;r.fillStyle=n.textColor,r.fillRect(e.width-o-$,e.height-4,$,2),r.fillRect(e.width-o-$,e.height-6,2,6),r.fillRect(e.width-o-2,e.height-6,2,6),r.textAlign="right",r.textBaseline="bottom",r.fillText(`${p} m`,e.width-o,e.height-6)}(o,r))},[r,o,function(t){N[t?"unshift":"push"]((()=>{r=t,n(0,r),n(1,o)}))}]}class Kt extends mt{constructor(t){super(),ht(this,t,Xt,It,l,{route:1})}}function Jt(t){let e,n,r,o,i;return{c(){e=k("label"),e.textContent="Pause (min)",n=v(),r=k("input"),C(e,"for","break"),C(r,"id","break"),C(r,"type","number"),C(r,"step","5"),C(r,"min","0"),r.required=!0},m(l,s){g(l,e,s),g(l,n,s),g(l,r,s),P(r,t[2].break),o||(i=y(r,"input",t[6]),o=!0)},p(t,e){4&e&&M(r.value)!==t[2].break&&P(r,t[2].break)},d(t){t&&b(e),t&&b(n),t&&b(r),o=!1,i()}}}function Vt(t){let e,n,r,i,l,s,c,a,u,d,f,h=t[1]<t[0].markers.length-1&&Jt(t);return{c(){e=k("label"),e.textContent="Name",n=v(),r=k("input"),i=v(),l=k("label"),l.textContent="Kommentar",s=v(),c=k("textarea"),a=v(),h&&h.c(),u=x(),C(e,"for","name"),C(r,"id","name"),C(r,"type","text"),r.required=!0,C(l,"for","comment"),C(c,"id","comment"),C(c,"class","svelte-1er4ovm")},m(o,m){g(o,e,m),g(o,n,m),g(o,r,m),P(r,t[2].name),g(o,i,m),g(o,l,m),g(o,s,m),g(o,c,m),P(c,t[2].comment),g(o,a,m),h&&h.m(o,m),g(o,u,m),d||(f=[y(r,"input",t[4]),y(c,"input",t[5])],d=!0)},p(t,e){4&e&&r.value!==t[2].name&&P(r,t[2].name),4&e&&P(c,t[2].comment),t[1]<t[0].markers.length-1?h?h.p(t,e):(h=Jt(t),h.c(),h.m(u.parentNode,u)):h&&(h.d(1),h=null)},d(t){t&&b(e),t&&b(n),t&&b(r),t&&b(i),t&&b(l),t&&b(s),t&&b(c),t&&b(a),h&&h.d(t),t&&b(u),d=!1,o(f)}}}function Zt(t){let e,n;return e=new Et({props:{title:"Wegpunkt bearbeiten",show:null!=t[1],$$slots:{default:[Vt]},$$scope:{ctx:t}}}),e.$on("close",t[3]),{c(){at(e.$$.fragment)},m(t,r){ut(e,t,r),n=!0},p(t,[n]){const r={};2&n&&(r.show=null!=t[1]),135&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){ot(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function Qt(t,e,n){let r,{route:o}=e,{selected:i=null}=e;return t.$$set=t=>{"route"in t&&n(0,o=t.route),"selected"in t&&n(1,i=t.selected)},t.$$.update=()=>{3&t.$$.dirty&&n(2,r=o.markers[i])},[o,i,r,function(){Ht(o),n(0,o),n(1,i=null)},function(){r.name=this.value,n(2,r),n(0,o),n(1,i)},function(){r.comment=this.value,n(2,r),n(0,o),n(1,i)},function(){r.break=M(this.value),n(2,r),n(0,o),n(1,i)}]}class Yt extends mt{constructor(t){super(),ht(this,t,Qt,Zt,l,{route:0,selected:1})}}function te(t,e,n){const r=t.slice();return r[6]=e[n],r}function ee(t){let e,n,r,o,i,l,s,c,a=(t[6].comment??"")+"",u=t[6].diff&&ne(t),d=t[6].break>0&&re(t);return{c(){e=k("tr"),n=k("td"),r=w(a),o=v(),u&&u.c(),i=v(),d&&d.c(),l=v(),s=k("td"),c=v(),C(n,"class","comment svelte-d5ew91"),C(s,"class","svelte-d5ew91"),C(e,"class","alt svelte-d5ew91")},m(t,a){g(t,e,a),m(e,n),m(n,r),m(e,o),u&&u.m(e,null),m(e,i),d&&d.m(e,null),m(e,l),m(e,s),m(e,c)},p(t,n){2&n&&a!==(a=(t[6].comment??"")+"")&&E(r,a),t[6].diff?u?u.p(t,n):(u=ne(t),u.c(),u.m(e,i)):u&&(u.d(1),u=null),t[6].break>0?d?d.p(t,n):(d=re(t),d.c(),d.m(e,l)):d&&(d.d(1),d=null)},d(t){t&&b(e),u&&u.d(),d&&d.d()}}}function ne(t){let e,n,r,o,i,l,s,c,a,u,d,f,h,p,$,x=Math.round(t[6].diff.height)+"",y=t[6].diff.distance.toFixed(1)+"",S=t[6].diff.effort.toFixed(1)+"",M=Pt(t[6].diff.duration)+"";return{c(){e=k("td"),n=w(x),r=w(" m"),o=v(),i=k("td"),l=w(y),s=w(" km"),c=v(),a=k("td"),u=w(S),d=w(" Lkm"),f=v(),h=k("td"),p=w(M),$=w(" h"),C(e,"class","number svelte-d5ew91"),C(i,"class","number svelte-d5ew91"),C(a,"class","number svelte-d5ew91"),C(h,"class","number svelte-d5ew91")},m(t,b){g(t,e,b),m(e,n),m(e,r),g(t,o,b),g(t,i,b),m(i,l),m(i,s),g(t,c,b),g(t,a,b),m(a,u),m(a,d),g(t,f,b),g(t,h,b),m(h,p),m(h,$)},p(t,e){2&e&&x!==(x=Math.round(t[6].diff.height)+"")&&E(n,x),2&e&&y!==(y=t[6].diff.distance.toFixed(1)+"")&&E(l,y),2&e&&S!==(S=t[6].diff.effort.toFixed(1)+"")&&E(u,S),2&e&&M!==(M=Pt(t[6].diff.duration)+"")&&E(p,M)},d(t){t&&b(e),t&&b(o),t&&b(i),t&&b(c),t&&b(a),t&&b(f),t&&b(h)}}}function re(t){let e,n,r,o=Pt(t[6].break/60)+"";return{c(){e=k("td"),n=w("+"),r=w(o),C(e,"class","number svelte-d5ew91")},m(t,o){g(t,e,o),m(e,n),m(e,r)},p(t,e){2&e&&o!==(o=Pt(t[6].break/60)+"")&&E(r,o)},d(t){t&&b(e)}}}function oe(t){let e,n,r,o,i,l,s,c,a,u,d,f,h,p,$,S,M,P,A,L,_,j,D,F,H,T,z,W,G,N,R,q,B,O,U=t[6].index+1+"",I=t[6].name+"",X=Math.round(t[6].height)+"",K=t[6].distance.toFixed(1)+"",J=t[6].effort.toFixed(1)+"",V=Pt(t[6].duration)+"",Z=At(t[6].time)+"";function Q(){return t[5](t[6])}G=new wt({props:{name:"edit"}});let Y=(t[6].comment||t[6].diff)&&ee(t);return{c(){e=k("tr"),n=k("td"),r=k("span"),o=w(U),i=v(),l=w(I),s=v(),c=k("td"),a=w(X),u=w(" m"),d=v(),f=k("td"),h=w(K),p=w(" km"),$=v(),S=k("td"),M=w(J),P=w(" Lkm"),A=v(),L=k("td"),_=w(V),j=w(" h"),D=v(),F=k("td"),H=w(Z),T=v(),z=k("td"),W=k("button"),at(G.$$.fragment),N=v(),Y&&Y.c(),R=x(),C(r,"class","pill svelte-d5ew91"),C(n,"class","name svelte-d5ew91"),C(c,"class","number svelte-d5ew91"),C(f,"class","number svelte-d5ew91"),C(S,"class","number svelte-d5ew91"),C(L,"class","number svelte-d5ew91"),C(F,"class","number svelte-d5ew91"),C(W,"class","pill"),C(z,"class","noprint svelte-d5ew91")},m(t,b){g(t,e,b),m(e,n),m(n,r),m(r,o),m(n,i),m(n,l),m(e,s),m(e,c),m(c,a),m(c,u),m(e,d),m(e,f),m(f,h),m(f,p),m(e,$),m(e,S),m(S,M),m(S,P),m(e,A),m(e,L),m(L,_),m(L,j),m(e,D),m(e,F),m(F,H),m(e,T),m(e,z),m(z,W),ut(G,W,null),g(t,N,b),Y&&Y.m(t,b),g(t,R,b),q=!0,B||(O=y(W,"click",Q),B=!0)},p(e,n){t=e,(!q||2&n)&&U!==(U=t[6].index+1+"")&&E(o,U),(!q||2&n)&&I!==(I=t[6].name+"")&&E(l,I),(!q||2&n)&&X!==(X=Math.round(t[6].height)+"")&&E(a,X),(!q||2&n)&&K!==(K=t[6].distance.toFixed(1)+"")&&E(h,K),(!q||2&n)&&J!==(J=t[6].effort.toFixed(1)+"")&&E(M,J),(!q||2&n)&&V!==(V=Pt(t[6].duration)+"")&&E(_,V),(!q||2&n)&&Z!==(Z=At(t[6].time)+"")&&E(H,Z),t[6].comment||t[6].diff?Y?Y.p(t,n):(Y=ee(t),Y.c(),Y.m(R.parentNode,R)):Y&&(Y.d(1),Y=null)},i(t){q||(rt(G.$$.fragment,t),q=!0)},o(t){ot(G.$$.fragment,t),q=!1},d(t){t&&b(e),dt(G),t&&b(N),Y&&Y.d(t),t&&b(R),B=!1,O()}}}function ie(t){let e,n,r,o,i,l,s,c;function a(e){t[3](e)}function u(e){t[4](e)}let d={};void 0!==t[0]&&(d.route=t[0]),void 0!==t[2]&&(d.selected=t[2]),e=new Yt({props:d}),N.push((()=>ct(e,"route",a))),N.push((()=>ct(e,"selected",u)));let f=t[1],h=[];for(let e=0;e<f.length;e+=1)h[e]=oe(te(t,f,e));const p=t=>ot(h[t],1,1,(()=>{h[t]=null}));return{c(){at(e.$$.fragment),o=v(),i=k("table"),l=k("tr"),l.innerHTML='<th class="svelte-d5ew91">Wegpunkt</th> \n        <th class="svelte-d5ew91">Höhe</th> \n        <th class="svelte-d5ew91">Distanz</th> \n        <th class="svelte-d5ew91">Aufwand</th> \n        <th class="svelte-d5ew91">Gehzeit</th> \n        <th class="svelte-d5ew91">Uhrzeit</th>',s=v();for(let t=0;t<h.length;t+=1)h[t].c();C(i,"class","svelte-d5ew91")},m(t,n){ut(e,t,n),g(t,o,n),g(t,i,n),m(i,l),m(i,s);for(let t=0;t<h.length;t+=1)h[t].m(i,null);c=!0},p(t,[o]){const l={};if(!n&&1&o&&(n=!0,l.route=t[0],I((()=>n=!1))),!r&&4&o&&(r=!0,l.selected=t[2],I((()=>r=!1))),e.$set(l),6&o){let e;for(f=t[1],e=0;e<f.length;e+=1){const n=te(t,f,e);h[e]?(h[e].p(n,o),rt(h[e],1)):(h[e]=oe(n),h[e].c(),rt(h[e],1),h[e].m(i,null))}for(et(),e=f.length;e<h.length;e+=1)p(e);nt()}},i(t){if(!c){rt(e.$$.fragment,t);for(let t=0;t<f.length;t+=1)rt(h[t]);c=!0}},o(t){ot(e.$$.fragment,t),h=h.filter(Boolean);for(let t=0;t<h.length;t+=1)ot(h[t]);c=!1},d(t){dt(e,t),t&&b(o),t&&b(i),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(h,t)}}}function le(t,e,n){let r,{route:o}=e,i=[];return t.$$set=t=>{"route"in t&&n(0,o=t.route)},t.$$.update=()=>{1&t.$$.dirty&&n(1,i=Wt(o))},[o,i,r,function(t){o=t,n(0,o)},function(t){r=t,n(2,r)},t=>n(2,r=t.index)]}class se extends mt{constructor(t){super(),ht(this,t,le,ie,l,{route:0})}}function ce(t){let e,n,r;return e=new wt({props:{name:"visibility"}}),{c(){at(e.$$.fragment),n=w(" Anzeigen")},m(t,o){ut(e,t,o),g(t,n,o),r=!0},i(t){r||(rt(e.$$.fragment,t),r=!0)},o(t){ot(e.$$.fragment,t),r=!1},d(t){dt(e,t),t&&b(n)}}}function ae(t){let e,n,r;return e=new wt({props:{name:"visibility_off"}}),{c(){at(e.$$.fragment),n=w(" Ausblenden")},m(t,o){ut(e,t,o),g(t,n,o),r=!0},i(t){r||(rt(e.$$.fragment,t),r=!0)},o(t){ot(e.$$.fragment,t),r=!1},d(t){dt(e,t),t&&b(n)}}}function ue(t){let e,n,r,o;return n=new Kt({props:{route:t[0]}}),{c(){e=k("div"),at(n.$$.fragment)},m(t,r){g(t,e,r),ut(n,e,null),o=!0},p(t,e){const r={};1&e&&(r.route=t[0]),n.$set(r)},i(t){o||(rt(n.$$.fragment,t),U((()=>{r||(r=lt(e,gt,{duration:100},!0)),r.run(1)})),o=!0)},o(t){ot(n.$$.fragment,t),r||(r=lt(e,gt,{duration:100},!1)),r.run(0),o=!1},d(t){t&&b(e),dt(n),t&&r&&r.end()}}}function de(t){let e,n,r,i,l,s,c,a,u,d,f,h,p,$,w,x,S,M,E,P,L,_,j,D,F;function H(e){t[4](e)}l=new wt({props:{name:"edit"}});let T={};function z(e){t[5](e)}void 0!==t[0]&&(T.route=t[0]),c=new Bt({props:T}),N.push((()=>ct(c,"route",H)));let W={};void 0!==t[0]&&(W.route=t[0]),p=new se({props:W}),N.push((()=>ct(p,"route",z)));const G=[ae,ce],R=[];function q(t,e){return t[1]?0:1}P=q(t),L=R[P]=G[P](t);let B=t[1]&&ue(t);return{c(){e=k("div"),n=k("h1"),r=v(),i=k("button"),at(l.$$.fragment),s=v(),at(c.$$.fragment),u=v(),d=k("div"),f=k("h2"),f.textContent="Marschzeittabelle",h=v(),at(p.$$.fragment),w=v(),x=k("div"),S=k("h2"),S.textContent="Höhenprofil",M=v(),E=k("button"),L.c(),_=v(),B&&B.c(),C(n,"id","title"),C(n,"contenteditable","true"),C(n,"class","svelte-gb9ui"),void 0===t[0].title&&U((()=>t[2].call(n))),C(i,"class","pill noprint svelte-gb9ui"),C(e,"class","options"),C(f,"class","svelte-gb9ui"),C(d,"class","table svelte-gb9ui"),C(S,"class","svelte-gb9ui"),C(E,"class","pill noprint svelte-gb9ui"),C(x,"class","profile svelte-gb9ui"),A(x,"noprint",!t[1])},m(o,a){g(o,e,a),m(e,n),void 0!==t[0].title&&(n.textContent=t[0].title),m(e,r),m(e,i),ut(l,i,null),m(e,s),ut(c,e,null),g(o,u,a),g(o,d,a),m(d,f),m(d,h),ut(p,d,null),g(o,w,a),g(o,x,a),m(x,S),m(x,M),m(x,E),R[P].m(E,null),m(x,_),B&&B.m(x,null),j=!0,D||(F=[y(n,"input",t[2]),y(i,"click",t[3]),y(E,"click",t[6])],D=!0)},p(t,[e]){1&e&&t[0].title!==n.textContent&&(n.textContent=t[0].title);const r={};!a&&1&e&&(a=!0,r.route=t[0],I((()=>a=!1))),c.$set(r);const o={};!$&&1&e&&($=!0,o.route=t[0],I((()=>$=!1))),p.$set(o);let i=P;P=q(t),P!==i&&(et(),ot(R[i],1,1,(()=>{R[i]=null})),nt(),L=R[P],L||(L=R[P]=G[P](t),L.c()),rt(L,1),L.m(E,null)),t[1]?B?(B.p(t,e),2&e&&rt(B,1)):(B=ue(t),B.c(),rt(B,1),B.m(x,null)):B&&(et(),ot(B,1,1,(()=>{B=null})),nt()),2&e&&A(x,"noprint",!t[1])},i(t){j||(rt(l.$$.fragment,t),rt(c.$$.fragment,t),rt(p.$$.fragment,t),rt(L),rt(B),j=!0)},o(t){ot(l.$$.fragment,t),ot(c.$$.fragment,t),ot(p.$$.fragment,t),ot(L),ot(B),j=!1},d(t){t&&b(e),dt(l),dt(c),t&&b(u),t&&b(d),dt(p),t&&b(w),t&&b(x),R[P].d(),B&&B.d(),D=!1,o(F)}}}function fe(t,e,n){let{route:r}=e,o=!0;return t.$$set=t=>{"route"in t&&n(0,r=t.route)},[r,o,function(){r.title=this.textContent,n(0,r)},()=>document.getElementById("title").focus(),function(t){r=t,n(0,r)},function(t){r=t,n(0,r)},()=>n(1,o=!o)]}class he extends mt{constructor(t){super(),ht(this,t,fe,de,l,{route:0})}}function me(e){let n,r,o,i,l,c,a,u,d,f,h,p,$,x,y,S,M,E,P,A,L;return $=new yt({props:{topic:"export",label:"Wie geht das?"}}),{c(){var t,e;n=k("div"),n.innerHTML='<h1 class="svelte-1k4l8dw">Marschzeit­tabelle<br/>leicht gemacht.</h1> \n<p class="subtitle svelte-1k4l8dw">Wir übertragen deine Route automatisch in eine Marschzeittabelle, damit du dich auf die Wanderplanung fokussieren kannst.</p>',r=v(),o=k("div"),i=k("div"),l=k("h2"),l.textContent="1. Planen",c=v(),a=k("p"),a.textContent="Route einzeichnen und Wegpunkte benennen - das kennst du bereits.",u=v(),d=k("h2"),d.textContent="2. Exportieren",f=v(),h=k("p"),p=w("In wenigen Klicks erledigt. "),at($.$$.fragment),x=v(),y=k("h2"),y.textContent="3. Hochladen",S=v(),M=k("p"),M.textContent="Jetzt noch Geschwindigkeit, Startzeit, Kommentare und Pausen hinzufügen.",E=v(),P=k("img"),C(n,"class","title svelte-1k4l8dw"),C(l,"class","svelte-1k4l8dw"),C(a,"class","svelte-1k4l8dw"),C(d,"class","svelte-1k4l8dw"),C(h,"class","svelte-1k4l8dw"),C(y,"class","svelte-1k4l8dw"),C(M,"class","svelte-1k4l8dw"),C(i,"class","svelte-1k4l8dw"),t=P.src,e=A="example.jpg",s||(s=document.createElement("a")),s.href=e,t!==s.href&&C(P,"src","example.jpg"),C(P,"alt","Beispiel"),C(P,"class","svelte-1k4l8dw"),C(o,"class","tutorial svelte-1k4l8dw")},m(t,e){g(t,n,e),g(t,r,e),g(t,o,e),m(o,i),m(i,l),m(i,c),m(i,a),m(i,u),m(i,d),m(i,f),m(i,h),m(h,p),ut($,h,null),m(i,x),m(i,y),m(i,S),m(i,M),m(o,E),m(o,P),L=!0},p:t,i(t){L||(rt($.$$.fragment,t),L=!0)},o(t){ot($.$$.fragment,t),L=!1},d(t){t&&b(n),t&&b(r),t&&b(o),dt($)}}}class pe extends mt{constructor(t){super(),ht(this,t,null,me,l,{})}}function $e(e){let n;return{c(){n=k("div"),C(n,"class","svelte-12lg60")},m(t,e){g(t,n,e)},p:t,i:t,o:t,d(t){t&&b(n)}}}class ge extends mt{constructor(t){super(),ht(this,t,null,$e,l,{})}}function be(t){return function(t){return new Promise(((e,n)=>{const r=new FileReader;r.addEventListener("load",(()=>e(r.result))),r.addEventListener("error",(()=>n("Die Datei konnte nicht gelesen werden."))),r.readAsText(t)}))}(t).then((t=>async function(t){const e=(new DOMParser).parseFromString(t,"application/xml");if(e.querySelector("parsererror"))throw"Die Datei ist nicht in gültigem XML-Format.";return e}(t))).then((e=>t.name.endsWith(".kml")?async function(t){const e=[],n=[],r=t=>{const[e,n]=t.split(",");return ke(n,e)},o=t.querySelectorAll("Placemark");for(let t of o){if(t.querySelector("LineString")){const n=t.querySelector("LineString coordinates").innerHTML.trim().split(" ").map((t=>r(t)));e.push(n)}if(t.querySelector("Point")){const e=t.querySelector("name").innerHTML.trim(),o=r(t.querySelector("Point coordinates").innerHTML);n.push({name:e,point:o})}}return{lines:e,markers:n}}(e):t.name.endsWith(".gpx")?async function(t){const e=[],n=[],r=t=>ke(t.getAttribute("lat"),t.getAttribute("lon")),o=t.querySelectorAll("trkseg");for(let t of o){const n=Array.from(t.querySelectorAll("trkpt")).map((t=>r(t)));e.push(n)}const i=t.querySelectorAll("trkpt > name");for(let t of i){const e=t.innerHTML.trim(),o=r(t.parentElement);n.push({name:e,point:o})}if(0===n.length){const e=t.querySelectorAll("wpt");for(let t of e){const e=t.querySelector("name").innerHTML.trim(),o=r(t);n.push({name:e,point:o})}}return{lines:e,markers:n}}(e):void 0)).then((({lines:e,markers:n})=>async function(t,e,n){if(0===t.length)throw"Die Route enthält keine Linie.";if(0===e.length)throw"Die Route enthält keine Wegpunkte.";for(;t.length>1;){const e=we(t);if(null==e)throw"Die Route enthält Linien, die nicht miteinander verbunden sind.";e.reverseFirst&&t[e.i].reverse(),e.reverseSecond&&t[e.j].reverse(),t[e.i].push(...t[e.j]),t.splice(e.j,1)}const r=t[0];let o=null;for(let t=0;t<r.length;t++){const n=e.filter((t=>null==o||!jt(t.point,o))).filter((e=>Dt(e.point,r[t])<10));if(0===n.length)continue;const i=n.filter((t=>null==t.index));if(n.length>1){throw`Mehrere Wegpunkte am selben Ort: ${i.map((t=>`"${t.name}"`)).join(", ")}.`}const l=n[0];null==l.index?l.index=t:e.push({name:l.name,point:l.point,index:t}),o=l.point}const i=e.filter((t=>null==t.index));if(i.length>0){throw`Wegpunkte nicht in der Nähe von Eckpunkten der Linie: ${i.map((t=>`"${t.name}"`)).join(", ")}.`}e.sort(((t,e)=>t.index-e.index));for(let t of e)t.break=0;return{line:r,markers:e,speed:4,start:0,title:n}}(e,n,t.name))).then((t=>async function(t){return t.lineProfile=await Ft(t.line,!1,100),t.markerProfile=await Ft(t.markers.map((e=>t.line[e.index])),!0,t.markers.length),Ht(t),t}(t)))}function ke(t,e){const[n,r]=class{static WGStoCH(t,e){return[this.WGStoCHy(t,e),this.WGStoCHx(t,e)]}static WGStoCHx(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 200147.07+308807.95*n+3745.25*Math.pow(r,2)+76.63*Math.pow(n,2)-194.56*Math.pow(r,2)*n+119.79*Math.pow(n,3)}static WGStoCHy(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 600072.37+211455.93*r-10938.51*r*n-.36*r*Math.pow(n,2)-44.54*Math.pow(r,3)}static CHtoWGS(t,e){return[this.CHtoWGSlng(t,e),this.CHtoWGSlat(t,e)]}static CHtoWGSlat(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(16.9023892+3.238272*r-.270978*Math.pow(n,2)-.002528*Math.pow(r,2)-.0447*Math.pow(n,2)*r-.014*Math.pow(r,3))/36}static CHtoWGSlng(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(2.6779094+4.728982*n+.791484*n*r+.1306*n*Math.pow(r,2)-.0436*Math.pow(n,3))/36}static DECtoSEX(t){const e=parseInt(t),n=parseInt(60*(t-e));return 60*(60*(t-e)-n)+60*n+3600*e}}.WGStoCH(Number(t),Number(e));return{x:n,y:r}}function we(t){const e=(t,e)=>Dt(t,e)<10;for(let n=0;n<t.length;n++)for(let r=n+1;r<t.length;r++){if(e(t[n][t[n].length-1],t[r][0]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!1};if(e(t[n][0],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!0};if(e(t[n][0],t[r][0]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!1};if(e(t[n][t[n].length-1],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!0}}return null}function ve(e){let n,r,i,l,s,c,a,u,d,f,h,p,$,x,S,M;return f=new wt({props:{name:"upload_file"}}),{c(){n=k("h2"),n.textContent="Route hochladen",r=v(),i=k("p"),i.innerHTML='Unterstützt sind <b>KML-Dateien</b> von <a href="https://map.geo.admin.ch" target="_blank">map.geo.admin.ch</a> oder der <a href="https://www.swisstopo.admin.ch/en/maps-data-online/maps-geodata-online/swisstopo-app.html" target="_blank">swisstopo-App</a>, sowie <b>GPX-Dateien</b> von <a href="https://www.outdooractive.com/de/routeplanner" target="_blank">outdooractive.com</a>.',l=v(),s=k("p"),s.textContent="Datei hierher ziehen oder...",c=v(),a=k("input"),u=v(),d=k("button"),at(f.$$.fragment),h=w(" Datei auswählen"),p=v(),$=k("br"),C(n,"class","svelte-cfhsjj"),C(a,"type","file"),C(a,"id","upload"),C(a,"accept",".kml, .gpx"),C(a,"class","svelte-cfhsjj")},m(t,o){g(t,n,o),g(t,r,o),g(t,i,o),g(t,l,o),g(t,s,o),g(t,c,o),g(t,a,o),g(t,u,o),g(t,d,o),ut(f,d,null),m(d,h),g(t,p,o),g(t,$,o),x=!0,S||(M=[y(a,"change",e[5]),y(d,"click",e[6])],S=!0)},p:t,i(t){x||(rt(f.$$.fragment,t),x=!0)},o(t){ot(f.$$.fragment,t),x=!1},d(t){t&&b(n),t&&b(r),t&&b(i),t&&b(l),t&&b(s),t&&b(c),t&&b(a),t&&b(u),t&&b(d),dt(f),t&&b(p),t&&b($),S=!1,o(M)}}}function xe(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Ce,then:Se,catch:ye,error:8,blocks:[,,,]};return st(n=t[1],o),{c(){e=x(),o.block.c()},m(t,n){g(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,r){t=e,o.ctx=t,2&r&&n!==(n=t[1])&&st(n,o)||function(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}(o,t,r)},i(t){r||(rt(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1){ot(o.blocks[t])}r=!1},d(t){t&&b(e),o.block.d(t),o.token=null,o=null}}}function ye(t){let e,n,r,o,i,l,s,c,a,u,d,f,h,p=t[8]+"";return a=new wt({props:{name:"refresh"}}),{c(){e=k("h2"),e.textContent="Hoppla!",n=v(),r=k("p"),o=w("Es gab einen Fehler beim Import:"),i=k("br"),l=w(p),s=v(),c=k("button"),at(a.$$.fragment),u=w(" Nochmal versuchen"),C(e,"class","svelte-cfhsjj"),C(c,"class","secondary")},m(p,$){g(p,e,$),g(p,n,$),g(p,r,$),m(r,o),m(r,i),m(r,l),g(p,s,$),g(p,c,$),ut(a,c,null),m(c,u),d=!0,f||(h=y(c,"click",t[4]),f=!0)},p(t,e){(!d||2&e)&&p!==(p=t[8]+"")&&E(l,p)},i(t){d||(rt(a.$$.fragment,t),d=!0)},o(t){ot(a.$$.fragment,t),d=!1},d(t){t&&b(e),t&&b(n),t&&b(r),t&&b(s),t&&b(c),dt(a),f=!1,h()}}}function Se(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Ce(e){let n,r,o,i,l,s;return l=new ge({}),{c(){n=k("h2"),n.textContent="Route wird gewandert...",r=v(),o=k("br"),i=v(),at(l.$$.fragment),C(n,"class","svelte-cfhsjj")},m(t,e){g(t,n,e),g(t,r,e),g(t,o,e),g(t,i,e),ut(l,t,e),s=!0},p:t,i(t){s||(rt(l.$$.fragment,t),s=!0)},o(t){ot(l.$$.fragment,t),s=!1},d(t){t&&b(n),t&&b(r),t&&b(o),t&&b(i),dt(l,t)}}}function Me(t){let e,n,r,i,l,s;const c=[xe,ve],a=[];function u(t,e){return t[0]&&t[0][0]?0:1}return n=u(t),r=a[n]=c[n](t),{c(){e=k("div"),r.c(),C(e,"class","svelte-cfhsjj")},m(r,o){g(r,e,o),a[n].m(e,null),i=!0,l||(s=[y(e,"drop",S(t[7])),y(e,"dragover",S(t[3]))],l=!0)},p(t,[o]){let i=n;n=u(t),n===i?a[n].p(t,o):(et(),ot(a[i],1,1,(()=>{a[i]=null})),nt(),r=a[n],r?r.p(t,o):(r=a[n]=c[n](t),r.c()),rt(r,1),r.m(e,null))},i(t){i||(rt(r),i=!0)},o(t){ot(r),i=!1},d(t){t&&b(e),a[n].d(),l=!1,o(s)}}}function Ee(t,e,n){let r,o,{route:i=null}=e;return t.$$set=t=>{"route"in t&&n(2,i=t.route)},t.$$.update=()=>{1&t.$$.dirty&&r&&r[0]&&n(1,o=be(r[0]).then((t=>new Promise((e=>setTimeout((()=>e(t)),500))))).then((t=>n(2,i=t))))},[r,o,i,function(e){W.call(this,t,e)},()=>n(0,r=null),function(){r=this.files,n(0,r)},()=>document.getElementById("upload").click(),t=>n(0,r=t.dataTransfer.files)]}class Pe extends mt{constructor(t){super(),ht(this,t,Ee,Me,l,{route:2})}}function Ae(t){let e,n,r,o,i,l;return o=new he({props:{route:t[0]}}),{c(){e=k("header"),e.innerHTML='<a href=".">❮ startseite</a>',n=v(),r=k("main"),at(o.$$.fragment),C(e,"class","noprint")},m(t,i){g(t,e,i),g(t,n,i),g(t,r,i),ut(o,r,null),l=!0},p(t,e){const n={};1&e&&(n.route=t[0]),o.$set(n)},i(t){l||(rt(o.$$.fragment,t),U((()=>{i||(i=lt(r,$t,{},!0)),i.run(1)})),l=!0)},o(t){ot(o.$$.fragment,t),i||(i=lt(r,$t,{},!1)),i.run(0),l=!1},d(t){t&&b(e),t&&b(n),t&&b(r),dt(o),t&&i&&i.end()}}}function Le(t){let e,n,r,o,i,l;function s(e){t[1](e)}n=new pe({});let c={};return void 0!==t[0]&&(c.route=t[0]),o=new Pe({props:c}),N.push((()=>ct(o,"route",s))),{c(){e=k("main"),at(n.$$.fragment),r=v(),at(o.$$.fragment)},m(t,i){g(t,e,i),ut(n,e,null),m(e,r),ut(o,e,null),l=!0},p(t,e){const n={};!i&&1&e&&(i=!0,n.route=t[0],I((()=>i=!1))),o.$set(n)},i(t){l||(rt(n.$$.fragment,t),rt(o.$$.fragment,t),l=!0)},o(t){ot(n.$$.fragment,t),ot(o.$$.fragment,t),l=!1},d(t){t&&b(e),dt(n),dt(o)}}}function _e(t){let e,n,r,o,i;const l=[Le,Ae],s=[];function c(t,e){return null==t[0]?0:1}return e=c(t),n=s[e]=l[e](t),{c(){n.c(),r=v(),o=k("footer"),o.innerHTML='<span>marschzeittabelle.ch</span> \n    <span class="noprint">| <a href="help">hilfe</a>\n        | <a href="https://github.com/ckolin/marschzeittabelle">github</a></span>',C(o,"class","svelte-1pxn2rk")},m(t,n){s[e].m(t,n),g(t,r,n),g(t,o,n),i=!0},p(t,[o]){let i=e;e=c(t),e===i?s[e].p(t,o):(et(),ot(s[i],1,1,(()=>{s[i]=null})),nt(),n=s[e],n?n.p(t,o):(n=s[e]=l[e](t),n.c()),rt(n,1),n.m(r.parentNode,r))},i(t){i||(rt(n),i=!0)},o(t){ot(n),i=!1},d(t){s[e].d(t),t&&b(r),t&&b(o)}}}function je(t,e,n){let r;return[r,function(t){r=t,n(0,r)}]}return new class extends mt{constructor(t){super(),ht(this,t,je,_e,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
