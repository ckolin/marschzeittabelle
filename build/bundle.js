var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function h(){return u(" ")}function d(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function f(t){return function(e){return e.preventDefault(),t.call(this,e)}}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t){return""===t?null:+t}function x(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}let $;function y(t){$=t}function v(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const b=[],k=[],w=[],M=[],C=Promise.resolve();let S=!1;function P(t){w.push(t)}const q=new Set;let E=0;function H(){const t=$;do{for(;E<b.length;){const t=b[E];E++,y(t),z(t.$$)}for(y(null),b.length=0,E=0;k.length;)k.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];q.has(e)||(q.add(e),e())}w.length=0}while(b.length);for(;M.length;)M.pop()();S=!1,q.clear(),y(t)}function z(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const T=new Set;let _;function L(t,e){t&&t.i&&(T.delete(t),t.i(e))}function A(t,e,n,r){if(t&&t.o){if(T.has(t))return;T.add(t),_.c.push((()=>{T.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function D(t){t&&t.c()}function W(t,n,i,o){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=t.$$;a&&a.m(n,i),o||P((()=>{const n=l.map(e).filter(s);c?c.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(P)}function G(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function j(t,e){-1===t.$$.dirty[0]&&(b.push(t),S||(S=!0,C.then(H)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function R(e,s,i,o,a,c,u,h=[-1]){const d=$;y(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(d?d.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:s.target||d.$$.root};u&&u(f.root);let p=!1;if(f.ctx=i?i(e,s.props||{},((t,n,...r)=>{const s=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),p&&j(e,t)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!o&&o(f.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);f.fragment&&f.fragment.l(t),t.forEach(l)}else f.fragment&&f.fragment.c();s.intro&&L(e.$$.fragment),W(e,s.target,s.anchor,s.customElement),H()}y(d)}class F{$destroy(){G(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function O(e){let n,r,s,i,h,d,f,p,m,g,$,y,v,b=e[0].markers[0].name+"",k=e[0].markers[e[0].markers.length-1].name+"",w=Math.round(e[0].distanceSum[e[0].line.length-1])+"";return{c(){n=u("Start: "),r=c("b"),s=u(b),i=c("br"),h=u("\nEnde: "),d=c("b"),f=u(k),p=c("br"),m=u("\nDistanz: "),g=c("b"),$=u(w),y=u(" m"),v=c("br")},m(t,e){a(t,n,e),a(t,r,e),o(r,s),a(t,i,e),a(t,h,e),a(t,d,e),o(d,f),a(t,p,e),a(t,m,e),a(t,g,e),o(g,$),o(g,y),a(t,v,e)},p(t,[e]){1&e&&b!==(b=t[0].markers[0].name+"")&&x(s,b),1&e&&k!==(k=t[0].markers[t[0].markers.length-1].name+"")&&x(f,k),1&e&&w!==(w=Math.round(t[0].distanceSum[t[0].line.length-1])+"")&&x($,w)},i:t,o:t,d(t){t&&l(n),t&&l(r),t&&l(i),t&&l(h),t&&l(d),t&&l(p),t&&l(m),t&&l(g),t&&l(v)}}}function N(t,e,n){let{route:r}=e;return t.$$set=t=>{"route"in t&&n(0,r=t.route)},[r]}class B extends F{constructor(t){super(),R(this,t,N,O,i,{route:0})}}class I{static equal(t,e){return t.x===e.x&&t.y===e.y}static add(t,e){return{x:t.x+e.x,y:t.y+e.y}}static subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}static multiply(t,e){return{x:t.x*e.x,y:t.y*e.y}}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static scale(t,e){return{x:t.x*e,y:t.y*e}}static rotate(t,e){return{x:Math.cos(e)*t.x-Math.sin(e)*t.y,y:Math.sin(e)*t.x+Math.cos(e)*t.y}}static angle(t){return Math.atan2(t.y,t.x)}static length(t){return Math.hypot(t.x,t.y)}static length2(t){return t.x**2+t.y**2}static normalize(t){const e=I.length(t);return 0===e?t:I.scale(t,1/e)}static floor(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}static flip(t){return{x:t.y,y:t.x}}static distance(t,e){return I.length(I.subtract(e,t))}static distance2(t,e){return I.length2(I.subtract(e,t))}}const X={backgroundColor:"white",textColor:"#222",darkerAccentColor:"#214B00",accentColor:"#3C7113",lighterAccentColor:"#87BC5E"};function J(e){let n;return{c(){n=c("canvas"),p(n,"width","300"),p(n,"height","300")},m(t,r){a(t,n,r),e[2](n)},p:t,i:t,o:t,d(t){t&&l(n),e[2](null)}}}function K(t,e,n){let r,{route:s}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{3&t.$$.dirty&&r&&function(t,e){const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);const r={x:1/0,y:1/0},s={x:-1/0,y:-1/0};for(let e of t.line)r.x=Math.min(e.x,r.x),r.y=Math.min(e.y,r.y),s.x=Math.max(e.x,s.x),s.y=Math.max(e.y,s.y);const i=I.subtract(s,r),o=I.add(r,I.scale(i,.5)),a=Math.min((e.width-20)/i.x,(e.height-20)/i.y),l=t=>{const n=I.add(I.scale(I.subtract(t,o),a),{x:.5*e.width,y:.5*e.height});return{x:n.x,y:e.height-n.y}};n.beginPath(),n.lineWidth=4,n.lineCap=n.lineJoin="round",n.strokeStyle=X.accentColor;let c=!0;for(let e of t.line){const t=l(e);c?(n.moveTo(t.x,t.y),c=!1):n.lineTo(t.x,t.y)}n.stroke(),n.fillStyle=X.darkerAccentColor;for(let e of t.markers){const r=l(t.line[e.index]);n.beginPath(),n.arc(r.x,r.y,10,0,2*Math.PI),n.fill()}n.font="bold 14px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillStyle=X.backgroundColor;for(let e=0;e<t.markers.length;e++){const r=t.markers[e],s=l(t.line[r.index]);n.fillText(e+1,s.x,s.y+.5)}}(s,r)},[r,s,function(t){k[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class U extends F{constructor(t){super(),R(this,t,K,J,i,{route:1})}}function Z(e){let n;return{c(){n=c("canvas"),p(n,"width","800"),p(n,"height","100")},m(t,r){a(t,n,r),e[2](n)},p:t,i:t,o:t,d(t){t&&l(n),e[2](null)}}}function V(t,e,n){let r,{route:s}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{3&t.$$.dirty&&r&&function(t,e){const n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);let r=1/0,s=-1/0;for(let e of t.lineProfile)r=Math.min(r,e.height),s=Math.max(s,e.height);const i=t.distanceSum[t.distanceSum.length-1],o=s-r,a={x:.5*i,y:r+.5*o},l=Math.min((e.height-20)/o,(e.width-20)/i),c=(t,n)=>{const r={x:t,y:n},s=I.add(I.scale(I.subtract(r,a),l),{x:.5*e.width,y:.5*e.height});return{x:s.x,y:e.height-s.y}},u=()=>{let e=!0;for(let r=0;r<t.lineProfile.length;r++){const s=c(t.lineProfileDistanceSum[r],t.lineProfile[r].height);e?(e=!1,n.moveTo(s.x,s.y)):n.lineTo(s.x,s.y)}};n.beginPath(),u();const h=c(0,s),d=c(0,r),f=c(i,r);n.lineTo(f.x,e.height),n.lineTo(d.x,e.height);const p=n.createLinearGradient(0,h.y,0,e.height);p.addColorStop(0,X.lighterAccentColor),p.addColorStop(1,X.backgroundColor),n.fillStyle=p,n.globalAlpha=.5,n.fill(),n.globalAlpha=1,n.beginPath(),u(),n.lineWidth=4,n.lineCap=n.lineJoin="round",n.strokeStyle=X.accentColor,n.stroke(),n.fillStyle=X.darkerAccentColor;for(let e=0;e<t.markerProfile.length;e++){const r=c(t.distanceSum[t.markers[e].index],t.markerProfile[e].height);n.beginPath(),n.arc(r.x,r.y,10,0,2*Math.PI),n.fill()}n.font="bold 14px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillStyle=X.backgroundColor;for(let e=0;e<t.markerProfile.length;e++){const r=c(t.distanceSum[t.markers[e].index],t.markerProfile[e].height);n.fillText(e+1,r.x,r.y+.5)}}(s,r)},[r,s,function(t){k[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class Q extends F{constructor(t){super(),R(this,t,V,Z,i,{route:1})}}function Y(t,e,n){const r=t.slice();return r[3]=e[n],r[5]=n,r}function tt(t){let e,n,r,s,i,d,f,m,g,$,y,v,b,k,w,M,C,S,P,q,E,H,z,T,_=t[3].index+"",L=t[3].name+"",A=Math.round(t[3].distance)+"",D=Math.round(t[3].height)+"",W=Math.round(t[3].time)+"",G=t[5]>0&&function(t){let e,n,r,s,i,d,f,m,g,$,y,v,b,k,w,M,C,S,P,q=Math.round(t[3].addedDistance)+"",E=Math.round(t[3].addedHeight)+"",H=Math.round(t[3].addedTime)+"";return{c(){e=c("tr"),n=c("td"),r=h(),s=c("td"),i=h(),d=c("td"),f=u(q),m=h(),g=c("td"),g.textContent="m",$=h(),y=c("td"),v=u(E),b=h(),k=c("td"),k.textContent="m",w=h(),M=c("td"),C=u(H),S=h(),P=c("td"),P.textContent="min",p(n,"class","svelte-1usxarx"),p(s,"class","svelte-1usxarx"),p(d,"class","number svelte-1usxarx"),p(g,"class","unit svelte-1usxarx"),p(y,"class","number svelte-1usxarx"),p(k,"class","unit svelte-1usxarx"),p(M,"class","number svelte-1usxarx"),p(P,"class","unit svelte-1usxarx"),p(e,"class","alt svelte-1usxarx")},m(t,l){a(t,e,l),o(e,n),o(e,r),o(e,s),o(e,i),o(e,d),o(d,f),o(e,m),o(e,g),o(e,$),o(e,y),o(y,v),o(e,b),o(e,k),o(e,w),o(e,M),o(M,C),o(e,S),o(e,P)},p(t,e){1&e&&q!==(q=Math.round(t[3].addedDistance)+"")&&x(f,q),1&e&&E!==(E=Math.round(t[3].addedHeight)+"")&&x(v,E),1&e&&H!==(H=Math.round(t[3].addedTime)+"")&&x(C,H)},d(t){t&&l(e)}}}(t);return{c(){G&&G.c(),e=h(),n=c("tr"),r=c("td"),s=c("span"),i=u(_),d=h(),f=c("td"),m=u(L),g=h(),$=c("td"),y=u(A),v=h(),b=c("td"),b.textContent="m",k=h(),w=c("td"),M=u(D),C=h(),S=c("td"),S.textContent="m ü.M.",P=h(),q=c("td"),E=u(W),H=h(),z=c("td"),z.textContent="min",T=h(),p(s,"class","svelte-1usxarx"),p(r,"class","index svelte-1usxarx"),p(f,"class","name svelte-1usxarx"),p($,"class","number svelte-1usxarx"),p(b,"class","unit svelte-1usxarx"),p(w,"class","number svelte-1usxarx"),p(S,"class","unit svelte-1usxarx"),p(q,"class","number svelte-1usxarx"),p(z,"class","unit svelte-1usxarx")},m(t,l){G&&G.m(t,l),a(t,e,l),a(t,n,l),o(n,r),o(r,s),o(s,i),o(n,d),o(n,f),o(f,m),o(n,g),o(n,$),o($,y),o(n,v),o(n,b),o(n,k),o(n,w),o(w,M),o(n,C),o(n,S),o(n,P),o(n,q),o(q,E),o(n,H),o(n,z),o(n,T)},p(t,e){t[5]>0&&G.p(t,e),1&e&&_!==(_=t[3].index+"")&&x(i,_),1&e&&L!==(L=t[3].name+"")&&x(m,L),1&e&&A!==(A=Math.round(t[3].distance)+"")&&x(y,A),1&e&&D!==(D=Math.round(t[3].height)+"")&&x(M,D),1&e&&W!==(W=Math.round(t[3].time)+"")&&x(E,W)},d(t){G&&G.d(t),t&&l(e),t&&l(n)}}}function et(e){let n,r,s,i=e[0],u=[];for(let t=0;t<i.length;t+=1)u[t]=tt(Y(e,i,t));return{c(){n=c("table"),r=c("tr"),r.innerHTML='<th class="svelte-1usxarx"></th> \n        <th class="svelte-1usxarx">Wegpunkt</th> \n        <th colspan="2" class="svelte-1usxarx">Distanz</th> \n        <th colspan="2" class="svelte-1usxarx">Höhe</th> \n        <th colspan="2" class="svelte-1usxarx">Zeit</th>',s=h();for(let t=0;t<u.length;t+=1)u[t].c();p(n,"class","svelte-1usxarx")},m(t,e){a(t,n,e),o(n,r),o(n,s);for(let t=0;t<u.length;t+=1)u[t].m(n,null)},p(t,[e]){if(1&e){let r;for(i=t[0],r=0;r<i.length;r+=1){const s=Y(t,i,r);u[r]?u[r].p(s,e):(u[r]=tt(s),u[r].c(),u[r].m(n,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=i.length}},i:t,o:t,d(t){t&&l(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(u,t)}}}function nt(t,e,n){let{route:r}=e,{speed:s}=e,i=[];return t.$$set=t=>{"route"in t&&n(1,r=t.route),"speed"in t&&n(2,s=t.speed)},t.$$.update=()=>{6&t.$$.dirty&&!window.isNaN(s)&&s>0&&n(0,i=function(t,e){const n=[];for(let r=0;r<t.markers.length;r++)n[r]={index:r+1,name:t.markers[r].name,distance:t.distanceSum[t.markers[r].index],height:t.markerProfile[r].height},n[r].time=n[r].distance/e/1e3*60,r>0&&(n[r].addedDistance=n[r].distance-n[r-1].distance,n[r].addedHeight=n[r].height-n[r-1].height,n[r].addedTime=n[r].time-n[r-1].time);return n}(r,s))},[i,r,s]}class rt extends F{constructor(t){super(),R(this,t,nt,et,i,{route:1,speed:2})}}function st(e){let n;return{c(){n=c("div"),n.innerHTML='<h1 class="svelte-q9f5fq">Marschzeittabelle<br/>leicht gemacht.</h1> \n    <p class="subtitle svelte-q9f5fq">Wir übertragen deine Route automatisch in eine Marschzeittabelle, damit du dich auf die wichtigen Teile der Planung konzentrieren kannst.</p> \n    <h2 class="svelte-q9f5fq">1. Route planen</h2> \n    <p class="svelte-q9f5fq">Route einzeichnen, Wegpunkte setzen - das kennst du bereits.</p> \n    <h2 class="svelte-q9f5fq">2. Exportieren und hochladen</h2> \n    <p class="svelte-q9f5fq">In wenigen Klicks erledigt.</p> \n    <h2 class="svelte-q9f5fq">3. Voilà!</h2> \n    <p class="svelte-q9f5fq">Schon hast du deine Marschzeittabelle.<br/>Jetzt noch Gewschwindigkeit, Uhrzeit und Pausen anpassen.</p>',p(n,"class","svelte-q9f5fq")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&l(n)}}}class it extends F{constructor(t){super(),R(this,t,null,st,i,{})}}function ot(t,e,n){const r={type:"LineString",coordinates:t.map((t=>[Math.round(t.x),Math.round(t.y)]))};return fetch(`https://api3.geo.admin.ch/rest/services/profile.json?sr=21781&distinct_points=${e}&nb_points=${n}&geom=${JSON.stringify(r)}`).then((t=>t.json())).then((n=>new Promise((r=>{let s=n.map((t=>({point:{x:t.easting,y:t.northing},height:t.alts.COMB})));e&&(s=s.filter((e=>t.some((t=>I.distance(e.point,t)<2))))),r(s)}))))}class at{constructor(t,e){this.line=t,this.markers=e,this.distanceSum=lt(this.line),this.lineProfile=null,this.markerProfile=null}reverse(){this.line.reverse(),this.markers.reverse(),this.markers.forEach((t=>t.index=this.line.length-t.index-1)),this.distanceSum=lt(this.line),this.lineProfile?.reverse(),this.markerProfile?.reverse(),this.lineProfileDistanceSum=lt(this.lineProfile.map((t=>t.point)))}async loadProfiles(){this.lineProfile=await ot(this.line,!1,100),this.markerProfile=await ot(this.markers.map((t=>this.line[t.index])),!0,this.markers.length),this.lineProfileDistanceSum=lt(this.lineProfile.map((t=>t.point)))}}function lt(t){const e=[];let n=0;for(let r=0;r<t.length;r++)n+=I.distance(t[Math.max(0,r-1)],t[r]),e[r]=n;return e}function ct(t){const e=t.split(",").map((t=>Number(t))),n=class{static WGStoCH(t,e){return[this.WGStoCHy(t,e),this.WGStoCHx(t,e)]}static WGStoCHx(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 200147.07+308807.95*n+3745.25*Math.pow(r,2)+76.63*Math.pow(n,2)-194.56*Math.pow(r,2)*n+119.79*Math.pow(n,3)}static WGStoCHy(t,e){const n=((t=this.DECtoSEX(t))-169028.66)/1e4,r=((e=this.DECtoSEX(e))-26782.5)/1e4;return 600072.37+211455.93*r-10938.51*r*n-.36*r*Math.pow(n,2)-44.54*Math.pow(r,3)}static CHtoWGS(t,e){return[this.CHtoWGSlng(t,e),this.CHtoWGSlat(t,e)]}static CHtoWGSlat(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(16.9023892+3.238272*r-.270978*Math.pow(n,2)-.002528*Math.pow(r,2)-.0447*Math.pow(n,2)*r-.014*Math.pow(r,3))/36}static CHtoWGSlng(t,e){const n=(t-6e5)/1e6,r=(e-2e5)/1e6;return 100*(2.6779094+4.728982*n+.791484*n*r+.1306*n*Math.pow(r,2)-.0436*Math.pow(n,3))/36}static DECtoSEX(t){const e=parseInt(t),n=parseInt(60*(t-e));return 60*(60*(t-e)-n)+60*n+3600*e}}.WGStoCH(e[1],e[0]);return{x:n[0],y:n[1]}}function ut(t){const e=(t,e)=>I.distance(t,e)<2;for(let n=0;n<t.length;n++)for(let r=n+1;r<t.length;r++){if(e(t[n][t[n].length-1],t[r][0]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!1};if(e(t[n][0],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!0};if(e(t[n][0],t[r][0]))return{i:n,j:r,reverseFirst:!0,reverseSecond:!1};if(e(t[n][t[n].length-1],t[r][t[r].length-1]))return{i:n,j:r,reverseFirst:!1,reverseSecond:!0}}return null}function ht(e){let n;return{c(){n=c("h3"),n.textContent="Route wird gewandert..."},m(t,e){a(t,n,e)},p:t,d(t){t&&l(n)}}}function dt(e){let n,r,s,i,o,u,f,m,x,g,$,y,v;return{c(){n=c("h2"),n.textContent="Route hochladen",r=h(),s=c("p"),s.innerHTML='Unterstützt sind Exporte im <b>KML-Format</b> von <a href="https://map.geo.admin.ch" target="_blank">map.geo.admin.ch</a> oder der <a href="https://www.swisstopo.admin.ch/en/maps-data-online/maps-geodata-online/swisstopo-app.html" target="_blank">swisstopo-App</a>.',i=h(),o=c("p"),o.textContent="Datei hierher ziehen oder...",u=h(),f=c("input"),m=h(),x=c("button"),x.innerHTML='<label for="upload" class="svelte-krr8rg">Datei auswählen</label>',g=h(),$=c("br"),p(f,"type","file"),p(f,"id","upload"),p(f,"accept",".kml"),p(f,"class","svelte-krr8rg")},m(t,l){a(t,n,l),a(t,r,l),a(t,s,l),a(t,i,l),a(t,o,l),a(t,u,l),a(t,f,l),a(t,m,l),a(t,x,l),a(t,g,l),a(t,$,l),y||(v=d(f,"change",e[3]),y=!0)},p:t,d(t){t&&l(n),t&&l(r),t&&l(s),t&&l(i),t&&l(o),t&&l(u),t&&l(f),t&&l(m),t&&l(x),t&&l(g),t&&l($),y=!1,v()}}}function ft(e){let n,s,i;function o(t,e){return t[0]&&t[0][0]?ht:dt}let u=o(e),h=u(e);return{c(){n=c("div"),h.c(),p(n,"class","svelte-krr8rg")},m(t,r){a(t,n,r),h.m(n,null),s||(i=[d(n,"drop",f(e[4])),d(n,"dragover",f(e[2]))],s=!0)},p(t,[e]){u===(u=o(t))&&h?h.p(t,e):(h.d(1),h=u(t),h&&(h.c(),h.m(n,null)))},i:t,o:t,d(t){t&&l(n),h.d(),s=!1,r(i)}}}function pt(t,e,n){let r,{route:s=null}=e;return t.$$set=t=>{"route"in t&&n(1,s=t.route)},t.$$.update=()=>{if(1&t.$$.dirty&&r&&r[0]){const t=new FileReader;t.addEventListener("load",(()=>{const e=function(t){const e=[],n=[],r=(new DOMParser).parseFromString(t,"application/xml").querySelectorAll("Placemark");for(let t of r){if(t.querySelector("LineString")){const n=t.querySelector("LineString coordinates").innerHTML.trim().split(" ").map((t=>ct(t)));e.push(n)}if(t.querySelector("Point")){const e=t.querySelector("name").innerHTML.trim(),r=ct(t.querySelector("Point coordinates").innerHTML);n.push({name:e,point:r})}}for(;e.length>1;){const t=ut(e);if(null==t)return void console.error("Lines are not connected");t.reverseFirst&&e[t.i].reverse(),t.reverseSecond&&e[t.j].reverse(),e[t.i].push(...e[t.j]),e.splice(t.j,1)}const s=e[0];for(let t of n){let e=0,n=1/0;for(let r=0;r<s.length;r++){const i=I.distance(t.point,s[r]);i<n&&(e=r,n=i)}t.index=e,delete t.point}return n.sort(((t,e)=>t.index-e.index)),new at(s,n)}(t.result);e.loadProfiles().then((()=>n(1,s=e)))})),t.readAsText(r[0])}},[r,s,function(e){v.call(this,t,e)},function(){r=this.files,n(0,r)},t=>n(0,r=t.dataTransfer.files)]}class mt extends F{constructor(t){super(),R(this,t,pt,ft,i,{route:1})}}function xt(t){let e,n,r,s,i;function o(e){t[4](e)}e=new it({});let c={};return void 0!==t[0]&&(c.route=t[0]),r=new mt({props:c}),k.push((()=>function(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}(r,"route",o))),{c(){D(e.$$.fragment),n=h(),D(r.$$.fragment)},m(t,s){W(e,t,s),a(t,n,s),W(r,t,s),i=!0},p(t,e){const n={};var i;!s&&1&e&&(s=!0,n.route=t[0],i=()=>s=!1,M.push(i)),r.$set(n)},i(t){i||(L(e.$$.fragment,t),L(r.$$.fragment,t),i=!0)},o(t){A(e.$$.fragment,t),A(r.$$.fragment,t),i=!1},d(t){G(e,t),t&&l(n),G(r,t)}}}function gt(t){let e,n,s,i,u,f,x,$,y,v,b,k,w,M,C,S,P,q,E,H,z,T,_,j,R,F,O,N,I,X,J,K,Z,V,Y,tt,et,nt;return f=new B({props:{route:t[0]}}),$=new U({props:{route:t[0]}}),X=new rt({props:{route:t[0],speed:t[1]}}),Y=new Q({props:{route:t[0]}}),{c(){e=c("div"),n=c("div"),s=c("div"),i=c("h2"),i.textContent="Route",u=h(),D(f.$$.fragment),x=h(),D($.$$.fragment),y=h(),v=c("div"),b=c("h2"),b.textContent="Optionen",k=h(),w=c("label"),w.textContent="Geschwindigkeit in Lkm/h",M=h(),C=c("input"),S=h(),P=c("br"),q=h(),E=c("button"),E.textContent="Richtung wechseln",H=h(),z=c("br"),T=h(),_=c("br"),j=h(),R=c("button"),R.textContent="Herunterladen",F=h(),O=c("div"),N=c("h2"),N.textContent="Marschzeittabelle",I=h(),D(X.$$.fragment),J=h(),K=c("div"),Z=c("h2"),Z.textContent="Höhenprofil",V=h(),D(Y.$$.fragment),p(s,"class","info svelte-5wcziq"),p(n,"class","header svelte-5wcziq"),p(w,"for","speed"),p(w,"class","svelte-5wcziq"),p(C,"id","speed"),p(C,"type","number"),p(C,"min","0.5"),p(C,"step","0.5"),p(C,"class","svelte-5wcziq"),p(E,"class","secondary"),p(v,"class","options svelte-5wcziq"),p(O,"class","table svelte-5wcziq"),p(K,"class","profile svelte-5wcziq"),p(e,"class","editor")},m(r,l){a(r,e,l),o(e,n),o(n,s),o(s,i),o(s,u),W(f,s,null),o(n,x),W($,n,null),o(e,y),o(e,v),o(v,b),o(v,k),o(v,w),o(v,M),o(v,C),g(C,t[1]),o(v,S),o(v,P),o(v,q),o(v,E),o(v,H),o(v,z),o(v,T),o(v,_),o(v,j),o(v,R),o(e,F),o(e,O),o(O,N),o(O,I),W(X,O,null),o(e,J),o(e,K),o(K,Z),o(K,V),W(Y,K,null),tt=!0,et||(nt=[d(C,"input",t[3]),d(E,"click",t[2]),d(R,"click",yt)],et=!0)},p(t,e){const n={};1&e&&(n.route=t[0]),f.$set(n);const r={};1&e&&(r.route=t[0]),$.$set(r),2&e&&m(C.value)!==t[1]&&g(C,t[1]);const s={};1&e&&(s.route=t[0]),2&e&&(s.speed=t[1]),X.$set(s);const i={};1&e&&(i.route=t[0]),Y.$set(i)},i(t){tt||(L(f.$$.fragment,t),L($.$$.fragment,t),L(X.$$.fragment,t),L(Y.$$.fragment,t),tt=!0)},o(t){A(f.$$.fragment,t),A($.$$.fragment,t),A(X.$$.fragment,t),A(Y.$$.fragment,t),tt=!1},d(t){t&&l(e),G(f),G($),G(X),G(Y),et=!1,r(nt)}}}function $t(t){let e,n,s,i,o,u;const d=[gt,xt],f=[];function m(t,e){return t[0]?0:1}return n=m(t),s=f[n]=d[n](t),{c(){e=c("main"),s.c(),i=h(),o=c("footer"),o.innerHTML='<span>marschzeittabelle.ch</span> \n    <span><a href="#">über diese seite</a> |\n        <a href="#">faq</a> |\n        <a href="https://github.com/ckolin/marschzeittabelle">github</a></span>',p(o,"class","svelte-5wcziq")},m(t,r){a(t,e,r),f[n].m(e,null),a(t,i,r),a(t,o,r),u=!0},p(t,[i]){let o=n;n=m(t),n===o?f[n].p(t,i):(_={r:0,c:[],p:_},A(f[o],1,1,(()=>{f[o]=null})),_.r||r(_.c),_=_.p,s=f[n],s?s.p(t,i):(s=f[n]=d[n](t),s.c()),L(s,1),s.m(e,null))},i(t){u||(L(s),u=!0)},o(t){A(s),u=!1},d(t){t&&l(e),f[n].d(),t&&l(i),t&&l(o)}}}function yt(){window.print()}function vt(t,e,n){let r,s=4;for(let t of Object.keys(X)){const e="--"+t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));document.documentElement.style.setProperty(e,X[t])}return[r,s,function(){r.reverse(),n(0,r)},function(){s=m(this.value),n(1,s)},function(t){r=t,n(0,r)}]}return new class extends F{constructor(t){super(),R(this,t,vt,$t,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
